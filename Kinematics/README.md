# Two distinct inhibitory neuronal classes govern acquisition and recall of spinal sensorimotor learning - Figure replication

## Step 1: Data
All the data you need to run this cord are stored under:
> ConditioningExample/DataExp1/Day1/pair1

It is made of three raw kinematic files returning the position of 5 joints (Foot, ankle, knee, hip and crest) along the three axis X, Y and Z

## Step 2: Format the kinematic component of each joint and for Learner and Control
In order to separate Learner and Control kinematics and to remove the potential artefact from the dataset, run:
```sh
sorting_raw_kinematic_file.m
```
It will save the formatted kinematics in:
> ConditioningExample/DataExp1/AnalyseDay1/pair1.

## Step 3: Extract foot position for vizualisation
First thing before going further, you need to load the predetermined height threshold, along the Z axis, for all the trial you want to analyse. For this, just load the matlab file:
```sh
ThrshDay.mat
```
which is generated by the matlab code 
```sh
threshold_files.m
```
Before running more code, the threhsold file should be loaded as one of your matlab variable. It will allow the next codes to directly normalised the height position based on the predetermined threshold. From this you can compute 3 types of codes, the foot position during the experiment or the foot position during the withdrawal period.

### - During the a defined time interval during the conditioning trial
Figure 1C, 1D, 1G, 2D, 5C, 5F, S1A, S2C, S4E, S4H, S8B, S9E, S1OB, S10C, 
For plotting the position of the foot during the 10min trial, you will need to run:
```sh
Plot_kinematic_10min_experiments.m
```
### - During the withdrawal of the foot
Figures S2A, S3C
For plotting the position of the foot for a 150ms after the withdrawal of the foot, you can run:
```sh
Withdrawal_foot_plot.m
```

## Step 4: Principal component analysis (PCA)-relative vizualisation

### - Extract kinematics from formatted data
To extract 3D kinematics based on supplementary table1 and supplementary table2 of the paper, you will have to run:
```sh
Extraction_parameters_for_PCA.m
```
It will extract 65 kinematics parameters related to the joints in 3D during the full conditioning experiment (600s time-window), and 63 kinematic parameters related the joint in 3D during the foot withrawal (500ms time-window). Extracted parameters can be saved in a .csv files, which you will need to load for computing the PCA.
Here we directly give the .csv files including all the animals presented in the PCA. 
To label what is the taks a mouse is invovled with, we use a number code which is the following:
- 1: WT mouse, learner or control, paired, invovled in a single training experiment
- 10: WT mouse, learner or control, paired, invovled in a single training experiment and which undergo reversal learning 24h after
- 3: Ptf1a_DTX mouse
- 4: Tlx3_DTX mouse
- 5: DMRT3_DTX mouse
- 6: En1_DTX mouse
- 7: Shox2_DTX mouse
- 8: Sim1_DTX mouse
In next part, please load the .csv file to run the PCA:
> PCA_Kinematics_WT_and_AblatedCellType.csv

### - Plot the PCA
Figure 1E, 1H, 2E, S2B
After you load the .csv file with all the kinematic information related to specific mouse condition, you can run the PCA using:
```sh
Run_PCA_and_parameters_analysis.m
```
You can extract information about a parameter you are intersted with (S2E) by checking the variable:
```sh
StandKine_notnormalized
```
You can extract factor loading (S2D) by checking the variable:
```sh
% For WT population
COEFF
COEFF_Dyn
% For ablated population
COEFF_Ablat
```
To run the PCA of En1ON and its subpopulation (S10D), you can also use the .csv called:
> PCA_kinematic_En1_and_subpopulation.csv

and follow the same process as with the PCA for WT animals.
