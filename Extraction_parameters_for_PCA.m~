%% - - - - Starting code:
tic
clear all
close all
w = warning ('off','all');


%% PARAMETERS INITIALIZATION
load ThrshDay.mat
ZM=zeros(3);

NbofPoint=1;
DivideBy=1;
nbframes=50;
a=0;
framed=20;
alpha=0.1;


%% - - - - Access to the different data

ExpNb=1;
Ndays = [1 0];
Npairs = [1 2 0];


% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % %
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % %
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % %
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % %

%% - - - EXTRACTING RAW DATA

% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % %
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % %
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % %
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % %


initNd=1;
while (Ndays(initNd))>0
    
    initNp=1;
    while (Npairs(initNd,initNp))>0
        
        a=a+1;
        
        XM4Amplitude=load(['/Users/simonlavaud/Desktop/Github_Kinematics/ConditioningExample/DataExp' num2str(ExpNb) '/AnalyseDay' num2str(Ndays(initNd)) '/pair' num2str(Npairs(initNd,initNp)) '/XmasterD' num2str(Ndays(initNd)) 'P' num2str(Npairs(initNd,initNp)) '.mat']);
        YM4Amplitude=load(['/Users/simonlavaud/Desktop/Github_Kinematics/ConditioningExample/DataExp' num2str(ExpNb) '/AnalyseDay' num2str(Ndays(initNd)) '/pair' num2str(Npairs(initNd,initNp)) '/YmasterD' num2str(Ndays(initNd)) 'P' num2str(Npairs(initNd,initNp)) '.mat']);
        ZM4Amplitude=load(['/Users/simonlavaud/Desktop/Github_Kinematics/ConditioningExample/DataExp' num2str(ExpNb) '/AnalyseDay' num2str(Ndays(initNd)) '/pair' num2str(Npairs(initNd,initNp)) '/ZmasterD' num2str(Ndays(initNd)) 'P' num2str(Npairs(initNd,initNp)) '.mat']);
        
        XY4Amplitude=load(['/Users/simonlavaud/Desktop/Github_Kinematics/ConditioningExample/DataExp' num2str(ExpNb) '/AnalyseDay' num2str(Ndays(initNd)) '/pair' num2str(Npairs(initNd,initNp)) '/XyokedD' num2str(Ndays(initNd)) 'P' num2str(Npairs(initNd,initNp)) '.mat']);
        YY4Amplitude=load(['/Users/simonlavaud/Desktop/Github_Kinematics/ConditioningExample/DataExp' num2str(ExpNb) '/AnalyseDay' num2str(Ndays(initNd)) '/pair' num2str(Npairs(initNd,initNp)) '/YyokedD' num2str(Ndays(initNd)) 'P' num2str(Npairs(initNd,initNp)) '.mat']);
        ZY4Amplitude=load(['/Users/simonlavaud/Desktop/Github_Kinematics/ConditioningExample/DataExp' num2str(ExpNb) '/AnalyseDay' num2str(Ndays(initNd)) '/pair' num2str(Npairs(initNd,initNp)) '/ZyokedD' num2str(Ndays(initNd)) 'P' num2str(Npairs(initNd,initNp)) '.mat']);
        
        
        XM4Amplitude=cell2mat(struct2cell(XM4Amplitude));
        YM4Amplitude=cell2mat(struct2cell(YM4Amplitude));
        ZM4Amplitude=cell2mat(struct2cell(ZM4Amplitude));
        
        XY4Amplitude=cell2mat(struct2cell(XY4Amplitude));
        YY4Amplitude=cell2mat(struct2cell(YY4Amplitude));
        ZY4Amplitude=cell2mat(struct2cell(ZY4Amplitude));
        
        % Exctract lenght of the recording if longer than 600 sec
        L(a)=floor(length(ZM4Amplitude));
        
        
        XM4Amplitude=XM4Amplitude(1:(floor(length(XM4Amplitude)/(DivideBy))),:);
        YM4Amplitude=YM4Amplitude(1:(floor(length(YM4Amplitude)/(DivideBy))),:);
        ZM4Amplitude=ZM4Amplitude(1:(floor(length(ZM4Amplitude)/(DivideBy))),:);
        
        XY4Amplitude=XY4Amplitude(1:(floor(length(XY4Amplitude)/(DivideBy))),:);
        YY4Amplitude=YY4Amplitude(1:(floor(length(YY4Amplitude)/(DivideBy))),:);
        ZY4Amplitude=ZY4Amplitude(1:(floor(length(ZY4Amplitude)/(DivideBy))),:);
        
        XM(1:length(XM4Amplitude),a,5)=XM4Amplitude(1:length(XM4Amplitude),5);%-XM4Amplitude(1,5);%-XM4Amplitude(1,1)
        XM(1:length(XM4Amplitude),a,4)=XM4Amplitude(1:length(XM4Amplitude),4);%-XM4Amplitude(1,4)-XM(1:length(XM4Amplitude),a,5);
        XM(1:length(XM4Amplitude),a,3)=XM4Amplitude(1:length(XM4Amplitude),3);%-XM4Amplitude(1,3)-XM(1:length(XM4Amplitude),a,4);
        XM(1:length(XM4Amplitude),a,2)=XM4Amplitude(1:length(XM4Amplitude),2);%-XM4Amplitude(1,2)-XM(1:length(XM4Amplitude),a,3);
        XM(1:length(XM4Amplitude),a,1)=XM4Amplitude(1:length(XM4Amplitude),1);%-XM4Amplitude(1,1)-XM(1:length(XM4Amplitude),a,2);
        
        XY(1:length(XY4Amplitude),a,5)=XY4Amplitude(1:length(XY4Amplitude),5);%-XY4Amplitude(1,5);
        XY(1:length(XY4Amplitude),a,4)=XY4Amplitude(1:length(XY4Amplitude),4);%-XY4Amplitude(1,4)-XY(1:length(XM4Amplitude),a,5);
        XY(1:length(XY4Amplitude),a,3)=XY4Amplitude(1:length(XY4Amplitude),3);%-XY4Amplitude(1,3)-XY(1:length(XM4Amplitude),a,4);
        XY(1:length(XY4Amplitude),a,2)=XY4Amplitude(1:length(XY4Amplitude),2);%-XY4Amplitude(1,2)-XY(1:length(XM4Amplitude),a,3);
        XY(1:length(XY4Amplitude),a,1)=XY4Amplitude(1:length(XY4Amplitude),1);%-XY4Amplitude(1,1)-XY(1:length(XM4Amplitude),a,2);
        
        YM(1:length(XM4Amplitude),a,5)=YM4Amplitude(1:length(XM4Amplitude),5);%-YM4Amplitude(1,5);
        YM(1:length(XM4Amplitude),a,4)=YM4Amplitude(1:length(XM4Amplitude),4);%-YM4Amplitude(1,4)-YM(1:length(XM4Amplitude),a,5);
        YM(1:length(XM4Amplitude),a,3)=YM4Amplitude(1:length(XM4Amplitude),3);%-YM4Amplitude(1,3)-YM(1:length(XM4Amplitude),a,4);
        YM(1:length(XM4Amplitude),a,2)=YM4Amplitude(1:length(XM4Amplitude),2);%-YM4Amplitude(1,2)-YM(1:length(XM4Amplitude),a,3);
        YM(1:length(XM4Amplitude),a,1)=YM4Amplitude(1:length(XM4Amplitude),1);%-YM4Amplitude(1,1)-YM(1:length(XM4Amplitude),a,2);
        
        YY(1:length(XY4Amplitude),a,5)=YY4Amplitude(1:length(XY4Amplitude),5);%-YY4Amplitude(1,5);
        YY(1:length(XY4Amplitude),a,4)=YY4Amplitude(1:length(XY4Amplitude),4);%-YY4Amplitude(1,4)-YY(1:length(XM4Amplitude),a,5);
        YY(1:length(XY4Amplitude),a,3)=YY4Amplitude(1:length(XY4Amplitude),3);%-YY4Amplitude(1,3)-YY(1:length(XM4Amplitude),a,4);
        YY(1:length(XY4Amplitude),a,2)=YY4Amplitude(1:length(XY4Amplitude),2);%-YY4Amplitude(1,2)-YY(1:length(XM4Amplitude),a,3);
        YY(1:length(XY4Amplitude),a,1)=YY4Amplitude(1:length(XY4Amplitude),1);%-YY4Amplitude(1,1)-YY(1:length(XM4Amplitude),a,2);
        
        
        ZM(1:length(XM4Amplitude),a,5)=ZM4Amplitude(1:length(XM4Amplitude),5);%-ZM4Amplitude(1,5);
        ZM(1:length(XM4Amplitude),a,4)=ZM4Amplitude(1:length(XM4Amplitude),4);%-ZM4Amplitude(1,4)-ZM(1:length(XM4Amplitude),a,5);
        ZM(1:length(XM4Amplitude),a,3)=ZM4Amplitude(1:length(XM4Amplitude),3);%-ZM4Amplitude(1,3)-ZM(1:length(XM4Amplitude),a,4);
        ZM(1:length(XM4Amplitude),a,2)=ZM4Amplitude(1:length(XM4Amplitude),2);%-ZM4Amplitude(1,2)-ZM(1:length(XM4Amplitude),a,3);
        ZM(1:length(XM4Amplitude),a,1)=ZM4Amplitude(1:length(XM4Amplitude),1);%-ZM4Amplitude(1,1)-ZM(1:length(XM4Amplitude),a,2);
        
        ZY(1:length(XY4Amplitude),a,5)=ZY4Amplitude(1:length(XY4Amplitude),5);%-ZY4Amplitude(1,5);
        ZY(1:length(XY4Amplitude),a,4)=ZY4Amplitude(1:length(XY4Amplitude),4);%-ZY4Amplitude(1,4)-ZY(1:length(XM4Amplitude),a,5);
        ZY(1:length(XY4Amplitude),a,3)=ZY4Amplitude(1:length(XY4Amplitude),3);%-ZY4Amplitude(1,3)-ZY(1:length(XM4Amplitude),a,4);
        ZY(1:length(XY4Amplitude),a,2)=ZY4Amplitude(1:length(XY4Amplitude),2);%-ZY4Amplitude(1,2)-ZY(1:length(XM4Amplitude),a,3);
        ZY(1:length(XY4Amplitude),a,1)=ZY4Amplitude(1:length(XY4Amplitude),1);%-ZY4Amplitude(1,1)-ZY(1:length(XM4Amplitude),a,2);
        
        
        % - - - Extract threshsold position from database
        T(a)=ThrshDay(Ndays(initNd),1+(2*(Npairs(initNd,initNp)-1)),ExpNb);
        TY(a)=ThrshDay(Ndays(initNd),(2*(Npairs(initNd,initNp))),ExpNb);
        
        % - - - Extract the foot position for the last 60 sec
        XSec(a)=L(a)/60;
        
        LastXSecMZF(a)=mean(ZM4Amplitude((L(a)-XSec(a)):L(a),1))-T(a);%-mean(ZM4Amplitude(1:XSec(a),1));
        LastXSecYZF(a)=mean(ZY4Amplitude((L(a)-XSec(a)):L(a),1))-TY(a);%-mean(ZY4Amplitude(1:XSec(a),1));

        if LastXSecMZF(a)>0
            ControlFootPos(a)=1;
        else
            ControlFootPos(a)=0;
        end
        
        if LastXSecYZF(a)>0
            ControlFootPosY(a)=1;
        else
            ControlFootPosY(a)=0;
        end
                
        % - - - Extract mean position with a time bin of 1 min = 60 sec
        for i=1:10
            dec=floor(L(a)/10);
            inter=(1+dec*(i-1)):(dec*(i));
            
            for joint=1:5
                
                ZMmean10(a,i,joint)=mean(ZM4Amplitude(inter,joint))-T(a)+3;
                ZYmean10(a,i,joint)=mean(ZY4Amplitude(inter,joint))-TY(a)+3;
                XMmean10(a,i,joint)=mean(XM4Amplitude(inter,joint))-mean(XM4Amplitude(1:100,joint));
                XYmean10(a,i,joint)=mean(XY4Amplitude(inter,joint))-mean(XY4Amplitude(1:100,joint));
                YMmean10(a,i,joint)=mean(YM4Amplitude(inter,joint))-mean(YM4Amplitude(1:100,joint));
                YYmean10(a,i,joint)=mean(YY4Amplitude(inter,joint))-mean(YY4Amplitude(1:100,joint));
                
            end
            
        end
        
        
        % - - - Global mean of foot position during 600 sec
        ZMmean(Npairs(initNd,initNp),initNd)=mean(ZM4Amplitude(:,1))-T(a)+3;
        ZYmean(Npairs(initNd,initNp),initNd)=mean(ZY4Amplitude(:,1))-TY(a)+3;
        
        
        
        initNp=initNp+1;
        
    end
    
    initNd=initNd+1;
    
end
Itermice=a;

% - - - Exclude nul values

for i=1:Itermice
    for j=1:L(i)
        for k=1:5
            if ZM(j,i,k)==0
                ZM(j,i,k)=NaN;
            end
            if ZY(j,i,k)==0
                ZY(j,i,k)=NaN;
            end
            
            if XY(j,i,k)==0
                XY(j,i,k)=NaN;
            end
            if XM(j,i,k)==0
                XM(j,i,k)=NaN;
            end
            
            if YM(j,i,k)==0
                YM(j,i,k)=NaN;
            end
            if YY(j,i,k)==0
                YY(j,i,k)=NaN;
            end
        end
    end
end


% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % %
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % %
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % %
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % %

% - - - COMPUTING KINEMATIC PARAMETERS - ADAPTIVE PHASE

% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % %
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % %
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % %
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % %


% - - -  Mean

for a=1:Itermice
    
    for joint=1:5
        
        if joint==1
            MeanZM(a,joint)=mean(ZM(1:L(a),a,joint),'omitnan')-T(a)+3;
            MeanZY(a,joint)=mean(ZY(1:L(a),a,joint),'omitnan')-TY(a)+3;

        else
            MeanZM(a,joint)=mean(ZM(1:L(a),a,joint),'omitnan')-mean(ZM(1:(L(a)/10),a,joint),'omitnan');
            MeanZY(a,joint)=mean(ZY(1:L(a),a,joint),'omitnan')-mean(ZY(1:(L(a)/10),a,joint),'omitnan');

        end
        
        MeanXM(a,joint)=mean(XM(1:L(a),a,joint),'omitnan')-mean(XM(1:(L(a)/10),a,joint),'omitnan');
        MeanXY(a,joint)=mean(XY(1:L(a),a,joint),'omitnan')-mean(XY(1:(L(a)/10),a,joint),'omitnan');
 
        MeanYM(a,joint)=mean(YM(1:L(a),a,joint),'omitnan')-mean(YM(1:(L(a)/10),a,joint),'omitnan');
        MeanYY(a,joint)=mean(YY(1:L(a),a,joint),'omitnan')-mean(YY(1:(L(a)/10),a,joint),'omitnan');

    end
end


% - - -  Amplitude
% To avoid noise artifact, amplitude is sorted from low to high
%Delta_amplitude is amplitude_90% - amplitude_10%

for a=1:Itermice
    
    clearvars VXM VYM VZM VXY VYY VZY
    
    [VXM IXM]=sort(XM(1:L(a),:,:));
    [VYM IYM]=sort(YM(1:L(a),:,:));
    [VZM IZM]=sort(ZM(1:L(a),:,:));
    
    [VXY IXY]=sort(XY(1:L(a),:,:));
    [VYY IYY]=sort(YY(1:L(a),:,:));
    [VZY IZY]=sort(ZY(1:L(a),:,:));
    
    for joint=1:5
        
        MaxAmpXM(a,joint)=VXM(L(a)-floor(L(a)/10),a,joint);
        MinAmpXM(a,joint)=VXM(floor(L(a)/10),a,joint);
        AmpXM(a,joint)=MaxAmpXM(a,joint)-MinAmpXM(a,joint) ;
        
        MaxAmpYM(a,joint)=VYM(L(a)-floor(L(a)/10),a,joint);
        MinAmpYM(a,joint)=VYM(floor(L(a)/10),a,joint);
        AmpYM(a,joint)=MaxAmpYM(a,joint)-MinAmpYM(a,joint);
        
        MaxAmpZM(a,joint)=VZM(L(a)-floor(L(a)/10),a,joint);
        MinAmpZM(a,joint)=VZM(floor(L(a)/10),a,joint);
        AmpZM=MaxAmpZM-MinAmpZM;
        
        
        MaxAmpXY(a,joint)=VXY(L(a)-floor(L(a)/10),a,joint);
        MinAmpXY(a,joint)=VXY(floor(L(a)/10),a,joint);
        AmpXY=MaxAmpXY-MinAmpXY;
        
        MaxAmpYY(a,joint)=VYY(L(a)-floor(L(a)/10),a,joint);
        MinAmpYY(a,joint)=VYY(floor(L(a)/10),a,joint);
        AmpYY=MaxAmpYY-MinAmpYY;
        
        MaxAmpZY(a,joint)=VZY(L(a)-floor(L(a)/10),a,joint);
        MinAmpZY(a,joint)=VZY(floor(L(a)/10),a,joint);
        AmpZY=MaxAmpZY-MinAmpZY;
        
        
    end
    
    
end


% - - - Calculation of shock events and time below threshold

for a=1:Itermice
    
    for i=2:L(a)
        if ZM(i,a,1)<T(a)
            BeingS(i,a)=1;
        else
            BeingS(i,a)=0;
        end
        
        if ZY(i,a,1)<TY(a)
            BeingSY(i,a)=1;
        else
            BeingSY(i,a)=0;
        end
        
    end
    
    TimeBeingS(a)=sum(BeingS(:,a));
    TimeBeingSY(a)=sum(BeingSY(:,a));
    
    PercentageTimeBeingS(a)=TimeBeingS(a)/L(a);
    PercentageTimeBeingSY(a)=TimeBeingSY(a)/L(a);
    
end


% - - - Mean for 2D and mean + std for 3D angles

index=1;

for a=1:Itermice
    
    for i=2:L(a)
        
        A=[YM(i,a,1) ZM(i,a,1)];
        B=[YM(i,a,2) ZM(i,a,2)];
        C=[YM(i,a,3) ZM(i,a,3)];
        D=[YM(i,a,4) ZM(i,a,4)];
        E=[YM(i,a,5) ZM(i,a,5)];
        
        AY=[YY(i,a,1) ZY(i,a,1)];
        BY=[YY(i,a,2) ZY(i,a,2)];
        CY=[YY(i,a,3) ZY(i,a,3)];
        DY=[YY(i,a,4) ZY(i,a,4)];
        EY=[YY(i,a,5) ZY(i,a,5)];
        
        BA=A-B;
        BC=C-B;
        BAY=AY-BY;
        BCY=CY-BY;
        
        CB=B-C;
        CD=D-C;
        CBY=BY-CY;
        CDY=DY-CY;
        
        DC=C-D;
        DE=E-D;
        DCY=CY-DY;
        DEY=EY-DY;
        
        Angle2DYZ(i,a,1)=acos(dot(BA,BC)/(norm(BA)*norm(BC)));%*180/pi;
        Angle2DYZ(i,a,2)=acos(dot(CB,CD)/(norm(CB)*norm(CD)));%*180/pi;
        Angle2DYZ(i,a,3)=acos(dot(DC,DE)/(norm(DC)*norm(DE)));%*180/pi;
        
        Angle2DYYZ(i,a,1)=acos(dot(BAY,BCY)/(norm(BAY)*norm(BCY)));%*180/pi;
        Angle2DYYZ(i,a,2)=acos(dot(CBY,CDY)/(norm(CBY)*norm(CDY)));%*180/pi;
        Angle2DYYZ(i,a,3)=acos(dot(DCY,DEY)/(norm(DCY)*norm(DEY)));%*180/pi;
        
        
        
        
        A=[XM(i,a,1) YM(i,a,1)];
        B=[XM(i,a,2) YM(i,a,2)];
        C=[XM(i,a,3) YM(i,a,3)];
        D=[XM(i,a,4) YM(i,a,4)];
        E=[XM(i,a,5) YM(i,a,5)];
        
        AY=[XY(i,a,1) YY(i,a,1)];
        BY=[XY(i,a,2) YY(i,a,2)];
        CY=[XY(i,a,3) YY(i,a,3)];
        DY=[XY(i,a,4) YY(i,a,4)];
        EY=[XY(i,a,5) YY(i,a,5)];
        
        BA=A-B;
        BC=C-B;
        BAY=AY-BY;
        BCY=CY-BY;
        
        CB=B-C;
        CD=D-C;
        CBY=BY-CY;
        CDY=DY-CY;
        
        DC=C-D;
        DE=E-D;
        DCY=CY-DY;
        DEY=EY-DY;
        
        Angle2DXY(i,a,1)=acos(dot(BA,BC)/(norm(BA)*norm(BC)));%*180/pi;
        Angle2DXY(i,a,2)=acos(dot(CB,CD)/(norm(CB)*norm(CD)));%*180/pi;
        Angle2DXY(i,a,3)=real(acos(dot(DC,DE)/(norm(DC)*norm(DE))));%*180/pi);
        
        Angle2DYXY(i,a,1)=acos(dot(BAY,BCY)/(norm(BAY)*norm(BCY)));%*180/pi;
        Angle2DYXY(i,a,2)=acos(dot(CBY,CDY)/(norm(CBY)*norm(CDY)));%*180/pi;
        Angle2DYXY(i,a,3)=real(acos(dot(DCY,DEY)/(norm(DCY)*norm(DEY))));%*180/pi);
        
        
        
        A=[ZM(i,a,1) XM(i,a,1)];
        B=[ZM(i,a,2) XM(i,a,2)];
        C=[ZM(i,a,3) XM(i,a,3)];
        D=[ZM(i,a,4) XM(i,a,4)];
        E=[ZM(i,a,5) XM(i,a,5)];
        
        AY=[ZY(i,a,1) XY(i,a,1)];
        BY=[ZY(i,a,2) XY(i,a,2)];
        CY=[ZY(i,a,3) XY(i,a,3)];
        DY=[ZY(i,a,4) XY(i,a,4)];
        EY=[ZY(i,a,5) XY(i,a,5)];
        
        
        
        BA=A-B;
        BC=C-B;
        
        CB=B-C;
        CD=D-C;
        
        DC=C-D;
        DE=E-D;
        
        BAY=AY-BY;
        BCY=CY-BY;
        
        CBY=BY-CY;
        CDY=DY-CY;
        
        DCY=CY-DY;
        DEY=EY-DY;
        
        Angle2DZX(i,a,1)=acos(dot(BA,BC)/(norm(BA)*norm(BC)));%*180/pi;
        Angle2DZX(i,a,2)=acos(dot(CB,CD)/(norm(CB)*norm(CD)));%*180/pi;
        Angle2DZX(i,a,3)=acos(dot(DC,DE)/(norm(DC)*norm(DE)));%*180/pi;
        
        Angle2DYZX(i,a,1)=acos(dot(BAY,BCY)/(norm(BAY)*norm(BCY)));%*180/pi;
        Angle2DYZX(i,a,2)=acos(dot(CBY,CDY)/(norm(CBY)*norm(CDY)));%*180/pi;
        Angle2DYZX(i,a,3)=acos(dot(DCY,DEY)/(norm(DCY)*norm(DEY)));%*180/pi;
        
        
        
        A=[XM(i,a,1) YM(i,a,1) ZM(i,a,1)];
        B=[XM(i,a,2) YM(i,a,2) ZM(i,a,2)];
        C=[XM(i,a,3) YM(i,a,3) ZM(i,a,3)];
        D=[XM(i,a,4) YM(i,a,4) ZM(i,a,4)];
        E=[XM(i,a,5) YM(i,a,5) ZM(i,a,5)];
        
        AY=[XY(i,a,1) YY(i,a,1) ZY(i,a,1)];
        BY=[XY(i,a,2) YY(i,a,2) ZY(i,a,2)];
        CY=[XY(i,a,3) YY(i,a,3) ZY(i,a,3)];
        DY=[XY(i,a,4) YY(i,a,4) ZY(i,a,4)];
        EY=[XY(i,a,5) YY(i,a,5) ZY(i,a,5)];
        
        
        BA=A-B;
        BC=C-B;
        
        CB=B-C;
        CD=D-C;
        
        DC=C-D;
        DE=E-D;
        
        
        BAY=AY-BY;
        BCY=CY-BY;
        
        CBY=BY-CY;
        CDY=DY-CY;
        
        DCY=CY-DY;
        DEY=EY-DY;
        
        Angle3D(i,a,1)= acos(dot(BA,BC)/(norm(BA)*norm(BC)))*180/pi;
        Angle3D(i,a,2)= acos(dot(CB,CD)/(norm(CB)*norm(CD)))*180/pi;
        Angle3D(i,a,3)= acos(dot(DC,DE)/(norm(DC)*norm(DE)))*180/pi;
        
        Angle3DY(i,a,1)= acos(dot(BAY,BCY)/(norm(BAY)*norm(BCY)))*180/pi;
        Angle3DY(i,a,2)= acos(dot(CBY,CDY)/(norm(CBY)*norm(CDY)))*180/pi;
        Angle3DY(i,a,3)= acos(dot(DCY,DEY)/(norm(DCY)*norm(DEY)))*180/pi;
        
        
    end
    
    
    for angle=1:3
        MeanAngle2DYZ(a,angle)=mean(Angle2DYZ(1:L(a),a,angle),'omitnan');%-Angle2DYZ(2,a,angle);
        MeanAngle2DZX(a,angle)=mean(Angle2DZX(1:L(a),a,angle),'omitnan');%-Angle2DZX(2,a,angle);
        MeanAngle2DXY(a,angle)=mean(Angle2DXY(1:L(a),a,angle),'omitnan');%-Angle2DXY(2,a,angle);
        MeanAngle2DYYZ(a,angle)=mean(Angle2DYYZ(1:L(a),a,angle),'omitnan');%-Angle2DYYZ(2,a,angle);
        MeanAngle2DYZX(a,angle)=mean(Angle2DYZX(1:L(a),a,angle),'omitnan');%-Angle2DYZX(2,a,angle);
        MeanAngle2DYXY(a,angle)=mean(Angle2DYXY(1:L(a),a,angle),'omitnan');%-Angle2DYXY(2,a,angle);
        
        MeanAngle3D(a,angle)=mean(Angle3D(1:L(a),a,angle),'omitnan');
        MeanAngle3DY(a,angle)=mean(Angle3DY(1:L(a),a,angle),'omitnan');
        

    end
    
    
end


% - - -  Mean speed of the joints

for a=1:Itermice
    
    for joint=1:5
        
        speedZM(a,joint)=mean(diff(ZM(1:L(a),a,joint)));
        speedZY(a,joint)=mean(diff(ZY(1:L(a),a,joint)));
        
        speedXM(a,joint)=mean(diff(XM(1:L(a),a,joint)));
        speedXY(a,joint)=mean(diff(XY(1:L(a),a,joint)));
        
        speedYM(a,joint)=mean(diff(YM(1:L(a),a,joint)));
        speedYY(a,joint)=mean(diff(YY(1:L(a),a,joint)));
        
    end
    
end


% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % %
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % %
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % %
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % %

% - - - COMPUTING KINEMATIC PARAMETERS - DYNAMIC PHASE

% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % %
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % %
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % %
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % %


% - - - Extract the movement after cues 5 frame before and 15 frame after
% Working at 30Hz :     5 frames = 5/30s ~= 16ms
%                       15 frames = 15/30 = 500ms

% Add in a tab all the isolate joint traces for each mice

nbframes=15;
pulsenumber=1;

for i=1:Itermice
    for j=6:(L(i)-nbframes)
        
        if ZM(j-1,i,1)>T(i) && ZM(j,i,1)<T(i) %&& (ZM(j+5,i,1)-ZM(j,i,1))>0.1 && (ZY(j+5,i,1)-ZY(j,i,1))>0.1
            
            pulsesZMF(:,pulsenumber,i)=ZM(j-5:j+nbframes,i,1) - ZM(j,i,1);
            pulsesZMA(:,pulsenumber,i)=ZM(j-5:j+nbframes,i,2) - ZM(j,i,1);
            pulsesZMK(:,pulsenumber,i)=ZM(j-5:j+nbframes,i,3) - ZM(j,i,1);
            pulsesZMH(:,pulsenumber,i)=ZM(j-5:j+nbframes,i,4) - ZM(j,i,1);
            pulsesZMI(:,pulsenumber,i)=ZM(j-5:j+nbframes,i,5) - ZM(j,i,1);
            
            pulsesZYF(:,pulsenumber,i)=ZY(j-5:j+nbframes,i,1) - ZY(j,i,1);
            pulsesZYA(:,pulsenumber,i)=ZY(j-5:j+nbframes,i,2) - ZY(j,i,1);
            pulsesZYK(:,pulsenumber,i)=ZY(j-5:j+nbframes,i,3) - ZY(j,i,1);
            pulsesZYH(:,pulsenumber,i)=ZY(j-5:j+nbframes,i,4) - ZY(j,i,1);
            pulsesZYI(:,pulsenumber,i)=ZY(j-5:j+nbframes,i,5) - ZY(j,i,1);
            
            pulsesXMF(:,pulsenumber,i)=XM(j-5:j+nbframes,i,1) - XM(j,i,1);
            pulsesXMA(:,pulsenumber,i)=XM(j-5:j+nbframes,i,2) - XM(j,i,1);
            pulsesXMK(:,pulsenumber,i)=XM(j-5:j+nbframes,i,3) - XM(j,i,1);
            pulsesXMH(:,pulsenumber,i)=XM(j-5:j+nbframes,i,4) - XM(j,i,1);
            pulsesXMI(:,pulsenumber,i)=XM(j-5:j+nbframes,i,5) - XM(j,i,1);
            
            pulsesXYF(:,pulsenumber,i)=XY(j-5:j+nbframes,i,1) - XY(j,i,1);
            pulsesXYA(:,pulsenumber,i)=XY(j-5:j+nbframes,i,2) - XY(j,i,1);
            pulsesXYK(:,pulsenumber,i)=XY(j-5:j+nbframes,i,3) - XY(j,i,1);
            pulsesXYH(:,pulsenumber,i)=XY(j-5:j+nbframes,i,4) - XY(j,i,1);
            pulsesXYI(:,pulsenumber,i)=XY(j-5:j+nbframes,i,5) - XY(j,i,1);
            
            pulsesYMF(:,pulsenumber,i)=YM(j-5:j+nbframes,i,1) - YM(j,i,1);
            pulsesYMA(:,pulsenumber,i)=YM(j-5:j+nbframes,i,2) - YM(j,i,1);
            pulsesYMK(:,pulsenumber,i)=YM(j-5:j+nbframes,i,3) - YM(j,i,1);
            pulsesYMH(:,pulsenumber,i)=YM(j-5:j+nbframes,i,4) - YM(j,i,1);
            pulsesYMI(:,pulsenumber,i)=YM(j-5:j+nbframes,i,5) - YM(j,i,1);
            
            pulsesYYF(:,pulsenumber,i)=YY(j-5:j+nbframes,i,1) - YY(j,i,1);
            pulsesYYA(:,pulsenumber,i)=YY(j-5:j+nbframes,i,2) - YY(j,i,1);
            pulsesYYK(:,pulsenumber,i)=YY(j-5:j+nbframes,i,3) - YY(j,i,1);
            pulsesYYH(:,pulsenumber,i)=YY(j-5:j+nbframes,i,4) - YY(j,i,1);
            pulsesYYI(:,pulsenumber,i)=YY(j-5:j+nbframes,i,5) - YY(j,i,1);
            
            
            AnglePulse3D_Ankle(:,pulsenumber,i)=(Angle3D(j-5:j+nbframes,i,1));
            AnglePulse3D_Knee(:,pulsenumber,i)=(Angle3D(j-5:j+nbframes,i,2));
            AnglePulse3D_Hip(:,pulsenumber,i)=(Angle3D(j-5:j+nbframes,i,3));
            
            AnglePulse3DY_Ankle(:,pulsenumber,i)=(Angle3DY(j-5:j+nbframes,i,1));
            AnglePulse3DY_Knee(:,pulsenumber,i)=(Angle3DY(j-5:j+nbframes,i,2));
            AnglePulse3DY_Hip(:,pulsenumber,i)=(Angle3DY(j-5:j+nbframes,i,3));
            
            pulsenumber=pulsenumber+1;
            
        end
        
        
    end
    
    pulsenumberstart(i)=pulsenumber;
    pulsenumber=1;
    
end


% - - - 10x upsample of the joint traces

nbframes=15;
pulsenumber=1;
framed=20;

x = 1:nbframes;
xq1 = .1:.1:nbframes;
sizexq1=size(xq1);

for i=1:Itermice
    for j=1:pulsenumberstart(i)-1
        
        
        yZMF=pulsesZMF(x,j,i);
        sZMF=spline(x,yZMF,xq1);
        pulsessortedZMFS(1:sizexq1(2),j,i)=sZMF(1,1:sizexq1(2));
        
        yZMA=pulsesZMA(x,j,i);
        sZMA=spline(x,yZMA,xq1);
        pulsessortedZMAS(1:sizexq1(2),j,i)=sZMA(1,1:sizexq1(2));
        
        yZMK=pulsesZMK(x,j,i);
        sZMK=spline(x,yZMK,xq1);
        pulsessortedZMKS(1:sizexq1(2),j,i)=sZMK(1,1:sizexq1(2));
        
        yZMH=pulsesZMH(x,j,i);
        sZMH=spline(x,yZMH,xq1);
        pulsessortedZMHS(1:sizexq1(2),j,i)=sZMH(1,1:sizexq1(2));
        
        yZMI=pulsesZMI(x,j,i);
        sZMI=spline(x,yZMI,xq1);
        pulsessortedZMIS(1:sizexq1(2),j,i)=sZMI(1,1:sizexq1(2));
        
        
        
        yYMF=pulsesYMF(x,j,i);
        sYMF=spline(x,yYMF,xq1);
        pulsessortedYMFS(1:sizexq1(2),j,i)=sYMF(1,1:sizexq1(2));
        
        yYMA=pulsesYMA(x,j,i);
        sYMA=spline(x,yYMA,xq1);
        pulsessortedYMAS(1:sizexq1(2),j,i)=sYMA(1,1:sizexq1(2));
        
        yYMK=pulsesYMK(x,j,i);
        sYMK=spline(x,yYMK,xq1);
        pulsessortedYMKS(1:sizexq1(2),j,i)=sYMK(1,1:sizexq1(2));
        
        yYMH=pulsesYMH(x,j,i);
        sYMH=spline(x,yYMH,xq1);
        pulsessortedYMHS(1:sizexq1(2),j,i)=sYMH(1,1:sizexq1(2));
        
        yYMI=pulsesYMI(x,j,i);
        sYMI=spline(x,yYMI,xq1);
        pulsessortedYMIS(1:sizexq1(2),j,i)=sYMI(1,1:sizexq1(2));
        
        
        
        yXMF=pulsesXMF(x,j,i);
        sXMF=spline(x,yXMF,xq1);
        pulsessortedXMFS(1:sizexq1(2),j,i)=sXMF(1,1:sizexq1(2));
        
        yXMA=pulsesXMA(x,j,i);
        sXMA=spline(x,yXMA,xq1);
        pulsessortedXMAS(1:sizexq1(2),j,i)=sXMA(1,1:sizexq1(2));
        
        yXMK=pulsesXMK(x,j,i);
        sXMK=spline(x,yXMK,xq1);
        pulsessortedXMKS(1:sizexq1(2),j,i)=sXMK(1,1:sizexq1(2));
        
        yXMH=pulsesXMH(x,j,i);
        sXMH=spline(x,yXMH,xq1);
        pulsessortedXMHS(1:sizexq1(2),j,i)=sXMH(1,1:sizexq1(2));
        
        yXMI=pulsesXMI(x,j,i);
        sXMI=spline(x,yXMI,xq1);
        pulsessortedXMIS(1:sizexq1(2),j,i)=sXMI(1,1:sizexq1(2));
        
        
        % %
        
        
        yZYF=pulsesZYF(x,j,i);
        sZYF=spline(x,yZYF,xq1);
        pulsessortedZYFS(1:sizexq1(2),j,i)=sZYF(1,1:sizexq1(2));
        
        yZYA=pulsesZYA(x,j,i);
        sZYA=spline(x,yZYA,xq1);
        pulsessortedZYAS(1:sizexq1(2),j,i)=sZYA(1,1:sizexq1(2));
        
        yZYK=pulsesZYK(x,j,i);
        sZYK=spline(x,yZYK,xq1);
        pulsessortedZYKS(1:sizexq1(2),j,i)=sZYK(1,1:sizexq1(2));
        
        yZYH=pulsesZYH(x,j,i);
        sZYH=spline(x,yZYH,xq1);
        pulsessortedZYHS(1:sizexq1(2),j,i)=sZYH(1,1:sizexq1(2));
        
        yZYI=pulsesZYI(x,j,i);
        sZYI=spline(x,yZYI,xq1);
        pulsessortedZYIS(1:sizexq1(2),j,i)=sZYI(1,1:sizexq1(2));
        
        
        
        yYYF=pulsesYYF(x,j,i);
        sYYF=spline(x,yYYF,xq1);
        pulsessortedYYFS(1:sizexq1(2),j,i)=sYYF(1,1:sizexq1(2));
        
        yYYA=pulsesYYA(x,j,i);
        sYYA=spline(x,yYYA,xq1);
        pulsessortedYYAS(1:sizexq1(2),j,i)=sYYA(1,1:sizexq1(2));
        
        yYYK=pulsesYYK(x,j,i);
        sYYK=spline(x,yYYK,xq1);
        pulsessortedYYKS(1:sizexq1(2),j,i)=sYYK(1,1:sizexq1(2));
        
        yYYH=pulsesYYH(x,j,i);
        sYYH=spline(x,yYYH,xq1);
        pulsessortedYYHS(1:sizexq1(2),j,i)=sYYH(1,1:sizexq1(2));
        
        yYYI=pulsesYYI(x,j,i);
        sYYI=spline(x,yYYI,xq1);
        pulsessortedYYIS(1:sizexq1(2),j,i)=sYYI(1,1:sizexq1(2));
        
        
        
        yXYF=pulsesXYF(x,j,i);
        sXYF=spline(x,yXYF,xq1);
        pulsessortedXYFS(1:sizexq1(2),j,i)=sXYF(1,1:sizexq1(2));
        
        yXYA=pulsesXYA(x,j,i);
        sXYA=spline(x,yXYA,xq1);
        pulsessortedXYAS(1:sizexq1(2),j,i)=sXYA(1,1:sizexq1(2));
        
        yXYK=pulsesXYK(x,j,i);
        sXYK=spline(x,yXYK,xq1);
        pulsessortedXYKS(1:sizexq1(2),j,i)=sXYK(1,1:sizexq1(2));
        
        yXYH=pulsesXYH(x,j,i);
        sXYH=spline(x,yXYH,xq1);
        pulsessortedXYHS(1:sizexq1(2),j,i)=sXYH(1,1:sizexq1(2));
        
        yXYI=pulsesXYI(x,j,i);
        sXYI=spline(x,yXYI,xq1);
        pulsessortedXYIS(1:sizexq1(2),j,i)=sXYI(1,1:sizexq1(2));
        
        
    end
    
end

% - - - - find the peak of the movement for alignement

b=1;
c=1;

for i=1:Itermice
    for j=1:pulsenumberstart(i)-1
        
        AAAA=findpeaks(pulsessortedZMFS(:,j,i),'MinPeakDistance',145);
        
        if isempty(AAAA)
            pks(j,i)=0;
            locs(j,i)=1;
        else
            
            [pks(j,i),locs(j,i)] = findpeaks(pulsessortedZMFS(:,j,i),'MinPeakDistance',148);
            
        end
        
    end
end


for i=1:Itermice
    for j=1:pulsenumberstart(i)-1
        
        AAAA=findpeaks(pulsessortedZYFS(:,j,i),'MinPeakDistance',145);
        
        if isempty(AAAA)
            pksY(j,i)=0;
            locsY(j,i)=1;
        else
            
            [pksY(j,i),locsY(j,i)] = findpeaks(pulsessortedZYFS(:,j,i),'MinPeakDistance',148);
            
        end
        
    end
end


framed=10;

for i=1:Itermice
    
    for j=1:pulsenumberstart(i)-1
        
        if locs(j,i)>10 && locs(j,i)<(150-50) %I(1,j,i)<110 && I(1,j,i)>framed
            pulsessortedZMF(:,b,i)=pulsessortedZMFS((locs(j,i)-framed):(locs(j,i)+framed*5),j,i)-pulsessortedZMFS(locs(j,i)-framed,j,i);%-ZtotCalib(i,1);%
            pulsessortedZMA(:,b,i)=pulsessortedZMAS((locs(j,i)-framed):(locs(j,i)+framed*5),j,i)-pulsessortedZMAS(locs(j,i)-framed,j,i);%-ZtotCalib(i,2);%
            pulsessortedZMK(:,b,i)=pulsessortedZMKS((locs(j,i)-framed):(locs(j,i)+framed*5),j,i)-pulsessortedZMKS(locs(j,i)-framed,j,i);%-ZtotCalib(i,3);%
            pulsessortedZMH(:,b,i)=pulsessortedZMHS((locs(j,i)-framed):(locs(j,i)+framed*5),j,i)-pulsessortedZMHS(locs(j,i)-framed,j,i);%-ZtotCalib(i,4);%
            pulsessortedZMI(:,b,i)=pulsessortedZMIS((locs(j,i)-framed):(locs(j,i)+framed*5),j,i)-pulsessortedZMIS(locs(j,i)-framed,j,i);%-ZtotCalib(i,5);%
            
            
            pulsessortedYMF(:,b,i)=pulsessortedYMFS((locs(j,i)-framed):(locs(j,i)+framed*5),j,i)-pulsessortedYMFS(locs(j,i)-framed,j,i);%-ZtotCalib(i,1);%
            pulsessortedYMA(:,b,i)=pulsessortedYMAS((locs(j,i)-framed):(locs(j,i)+framed*5),j,i)-pulsessortedYMAS(locs(j,i)-framed,j,i);%-ZtotCalib(i,2);%
            pulsessortedYMK(:,b,i)=pulsessortedYMKS((locs(j,i)-framed):(locs(j,i)+framed*5),j,i)-pulsessortedYMKS(locs(j,i)-framed,j,i);%-ZtotCalib(i,3);%
            pulsessortedYMH(:,b,i)=pulsessortedYMHS((locs(j,i)-framed):(locs(j,i)+framed*5),j,i)-pulsessortedYMHS(locs(j,i)-framed,j,i);%-ZtotCalib(i,4);%
            pulsessortedYMI(:,b,i)=pulsessortedYMIS((locs(j,i)-framed):(locs(j,i)+framed*5),j,i)-pulsessortedYMIS(locs(j,i)-framed,j,i);%-ZtotCalib(i,5);%
            
            
            pulsessortedXMF(:,b,i)=pulsessortedXMFS((locs(j,i)-framed):(locs(j,i)+framed*5),j,i)-pulsessortedXMFS(locs(j,i)-framed,j,i);%-ZtotCalib(i,1);%
            pulsessortedXMA(:,b,i)=pulsessortedXMAS((locs(j,i)-framed):(locs(j,i)+framed*5),j,i)-pulsessortedXMAS(locs(j,i)-framed,j,i);%-ZtotCalib(i,2);%
            pulsessortedXMK(:,b,i)=pulsessortedXMKS((locs(j,i)-framed):(locs(j,i)+framed*5),j,i)-pulsessortedXMKS(locs(j,i)-framed,j,i);%-ZtotCalib(i,3);%
            pulsessortedXMH(:,b,i)=pulsessortedXMHS((locs(j,i)-framed):(locs(j,i)+framed*5),j,i)-pulsessortedXMHS(locs(j,i)-framed,j,i);%-ZtotCalib(i,4);%
            pulsessortedXMI(:,b,i)=pulsessortedXMIS((locs(j,i)-framed):(locs(j,i)+framed*5),j,i)-pulsessortedXMIS(locs(j,i)-framed,j,i);%-ZtotCalib(i,5);%
            
            b=b+1;
            
        end
        
        if locsY(j,i)>10 && locsY(j,i)<(150-50)
            
            pulsessortedZYF(:,c,i)=pulsessortedZYFS((locsY(j,i)-framed):(locsY(j,i)+framed*5),j,i)-pulsessortedZYFS(locsY(j,i)-framed,j,i);%-ZtotCalib(i,1);%
            pulsessortedZYA(:,c,i)=pulsessortedZYAS((locsY(j,i)-framed):(locsY(j,i)+framed*5),j,i)-pulsessortedZYAS(locsY(j,i)-framed,j,i);%-ZtotCalib(i,2);%
            pulsessortedZYK(:,c,i)=pulsessortedZYKS((locsY(j,i)-framed):(locsY(j,i)+framed*5),j,i)-pulsessortedZYKS(locsY(j,i)-framed,j,i);%-ZtotCalib(i,3);%
            pulsessortedZYH(:,c,i)=pulsessortedZYHS((locsY(j,i)-framed):(locsY(j,i)+framed*5),j,i)-pulsessortedZYHS(locsY(j,i)-framed,j,i);%-ZtotCalib(i,4);%
            pulsessortedZYI(:,c,i)=pulsessortedZYIS((locsY(j,i)-framed):(locsY(j,i)+framed*5),j,i)-pulsessortedZYIS(locsY(j,i)-framed,j,i);%-ZtotCalib(i,5);%
            
            
            pulsessortedYYF(:,c,i)=pulsessortedYYFS((locsY(j,i)-framed):(locsY(j,i)+framed*5),j,i)-pulsessortedYYFS(locsY(j,i)-framed,j,i);%-ZtotCalib(i,1);%
            pulsessortedYYA(:,c,i)=pulsessortedYYAS((locsY(j,i)-framed):(locsY(j,i)+framed*5),j,i)-pulsessortedYYAS(locsY(j,i)-framed,j,i);%-ZtotCalib(i,2);%
            pulsessortedYYK(:,c,i)=pulsessortedYYKS((locsY(j,i)-framed):(locsY(j,i)+framed*5),j,i)-pulsessortedYYKS(locsY(j,i)-framed,j,i);%-ZtotCalib(i,3);%
            pulsessortedYYH(:,c,i)=pulsessortedYYHS((locsY(j,i)-framed):(locsY(j,i)+framed*5),j,i)-pulsessortedYYHS(locsY(j,i)-framed,j,i);%-ZtotCalib(i,4);%
            pulsessortedYYI(:,c,i)=pulsessortedYYIS((locsY(j,i)-framed):(locsY(j,i)+framed*5),j,i)-pulsessortedYYIS(locsY(j,i)-framed,j,i);%-ZtotCalib(i,5);%
            
            
            pulsessortedXYF(:,c,i)=pulsessortedXYFS((locsY(j,i)-framed):(locsY(j,i)+framed*5),j,i)-pulsessortedXYFS(locsY(j,i)-framed,j,i);%-ZtotCalib(i,1);%
            pulsessortedXYA(:,c,i)=pulsessortedXYAS((locsY(j,i)-framed):(locsY(j,i)+framed*5),j,i)-pulsessortedXYAS(locsY(j,i)-framed,j,i);%-ZtotCalib(i,2);%
            pulsessortedXYK(:,c,i)=pulsessortedXYKS((locsY(j,i)-framed):(locsY(j,i)+framed*5),j,i)-pulsessortedXYKS(locsY(j,i)-framed,j,i);%-ZtotCalib(i,3);%
            pulsessortedXYH(:,c,i)=pulsessortedXYHS((locsY(j,i)-framed):(locsY(j,i)+framed*5),j,i)-pulsessortedXYHS(locsY(j,i)-framed,j,i);%-ZtotCalib(i,4);%
            pulsessortedXYI(:,c,i)=pulsessortedXYIS((locsY(j,i)-framed):(locsY(j,i)+framed*5),j,i)-pulsessortedXYIS(locsY(j,i)-framed,j,i);%-ZtotCalib(i,5);%
            
            
            c=c+1;
        end
        
    end
    
    nbpulsessortedM(i)=b;
    b=1;
    
    nbpulsessortedY(i)=c;
    c=1;
    
    
end



% - - - - Re-order the table to match with alignement

b=1;
bY=1;

for i=1:Itermice
    for j=1:nbpulsessortedM(i)-1
        if pulsessortedZMF(framed,j,i)>0 && pulsessortedZMF(framed,j,i)<3
            
            pulsessortedZMF2(b,1:61,i)=pulsessortedZMF(:,j,i);%-CalibAmpZM(a,1);
            pulsessortedZMA2(b,1:61,i)=pulsessortedZMA(:,j,i);%-CalibAmpZM(a,2);
            pulsessortedZMK2(b,1:61,i)=pulsessortedZMK(:,j,i);%-CalibAmpZM(a,3);
            pulsessortedZMH2(b,1:61,i)=pulsessortedZMH(:,j,i);%-CalibAmpZM(a,4);
            pulsessortedZMI2(b,1:61,i)=pulsessortedZMI(:,j,i);%-CalibAmpZM(a,5);
            
            
            pulsessortedXMF2(b,1:61,i)=pulsessortedXMF(:,j,i);%-CalibAmpZM(a,1);
            pulsessortedXMA2(b,1:61,i)=pulsessortedXMA(:,j,i);%-CalibAmpZM(a,2);
            pulsessortedXMK2(b,1:61,i)=pulsessortedXMK(:,j,i);%-CalibAmpZM(a,3);
            pulsessortedXMH2(b,1:61,i)=pulsessortedXMH(:,j,i);%-CalibAmpZM(a,4);
            pulsessortedXMI2(b,1:61,i)=pulsessortedXMI(:,j,i);%-CalibAmpZM(a,5);
            
            
            pulsessortedYMF2(b,1:61,i)=pulsessortedYMF(:,j,i);%-CalibAmpZM(a,1);
            pulsessortedYMA2(b,1:61,i)=pulsessortedYMA(:,j,i);%-CalibAmpZM(a,2);
            pulsessortedYMK2(b,1:61,i)=pulsessortedYMK(:,j,i);%-CalibAmpZM(a,3);
            pulsessortedYMH2(b,1:61,i)=pulsessortedYMH(:,j,i);%-CalibAmpZM(a,4);
            pulsessortedYMI2(b,1:61,i)=pulsessortedYMI(:,j,i);%-CalibAmpZM(a,5);
            
            b=b+1;
        end
        
    end
    
    nbpulsessorted2(i)=b;
    b=1;
    
end


for i=1:Itermice
    for j=1:nbpulsessortedY(i)-1
        if pulsessortedZYF(framed,j,i)>0 && pulsessortedZYF(framed,j,i)<3
            
            pulsessortedZYF2(bY,1:61,i)=pulsessortedZYF(:,j,i);%-CalibAmpZM(a,1);
            pulsessortedZYA2(bY,1:61,i)=pulsessortedZYA(:,j,i);%-CalibAmpZM(a,2);
            pulsessortedZYK2(bY,1:61,i)=pulsessortedZYK(:,j,i);%-CalibAmpZM(a,3);
            pulsessortedZYH2(bY,1:61,i)=pulsessortedZYH(:,j,i);%-CalibAmpZM(a,4);
            pulsessortedZYI2(bY,1:61,i)=pulsessortedZYI(:,j,i);%-CalibAmpZM(a,5);
            
            
            pulsessortedXYF2(bY,1:61,i)=pulsessortedXYF(:,j,i);%-CalibAmpZM(a,1);
            pulsessortedXYA2(bY,1:61,i)=pulsessortedXYA(:,j,i);%-CalibAmpZM(a,2);
            pulsessortedXYK2(bY,1:61,i)=pulsessortedXYK(:,j,i);%-CalibAmpZM(a,3);
            pulsessortedXYH2(bY,1:61,i)=pulsessortedXYH(:,j,i);%-CalibAmpZM(a,4);
            pulsessortedXYI2(bY,1:61,i)=pulsessortedXYI(:,j,i);%-CalibAmpZM(a,5);
            
            
            pulsessortedYYF2(bY,1:61,i)=pulsessortedYYF(:,j,i);%-CalibAmpZM(a,1);
            pulsessortedYYA2(bY,1:61,i)=pulsessortedYYA(:,j,i);%-CalibAmpZM(a,2);
            pulsessortedYYK2(bY,1:61,i)=pulsessortedYYK(:,j,i);%-CalibAmpZM(a,3);
            pulsessortedYYH2(bY,1:61,i)=pulsessortedYYH(:,j,i);%-CalibAmpZM(a,4);
            pulsessortedYYI2(bY,1:61,i)=pulsessortedYYI(:,j,i);%-CalibAmpZM(a,5);
            
            bY=bY+1;
        end
        
    end
    
    nbpulsessortedY2(i)=bY;
    bY=1;
    
end

PXMF=squeeze(mean(pulsesXMF(:,:,:),2));
PXMA=squeeze(mean(pulsesXMA(:,:,:),2));
PXMK=squeeze(mean(pulsesXMK(:,:,:),2));
PXMH=squeeze(mean(pulsesXMH(:,:,:),2));
PXMC=squeeze(mean(pulsesXMI(:,:,:),2));

PYMF=squeeze(mean(pulsesYMF(:,:,:),2));
PYMA=squeeze(mean(pulsesYMA(:,:,:),2));
PYMK=squeeze(mean(pulsesYMK(:,:,:),2));
PYMH=squeeze(mean(pulsesYMH(:,:,:),2));
PYMC=squeeze(mean(pulsesYMF(:,:,:),2));

PZMF=squeeze(mean(pulsesZMF(:,:,:),2));
PZMA=squeeze(mean(pulsesZMA(:,:,:),2));
PZMK=squeeze(mean(pulsesZMK(:,:,:),2));
PZMH=squeeze(mean(pulsesZMH(:,:,:),2));
PZMC=squeeze(mean(pulsesZMI(:,:,:),2));

PXMF=PXMF-PXMF(1,:);
PXMA=PXMA-PXMA(1,:);
PXMK=PXMK-PXMK(1,:);
PXMH=PXMH-PXMH(1,:);
PXMC=PXMC-PXMC(1,:);

PYMF=PYMF-PYMF(1,:);
PYMA=PYMA-PYMA(1,:);
PYMK=PYMK-PYMK(1,:);
PYMH=PYMH-PYMH(1,:);
PYMC=PYMC-PYMC(1,:);

PZMF=PZMF-PZMF(1,:);
PZMA=PZMA-PZMA(1,:);
PZMK=PZMK-PZMK(1,:);
PZMH=PZMH-PZMH(1,:);
PZMC=PZMC-PZMC(1,:);

% % % % % % % % % % % % % % % % % %

PXYF=squeeze(mean(pulsesXYF(:,:,:),2));
PXYA=squeeze(mean(pulsesXYA(:,:,:),2));
PXYK=squeeze(mean(pulsesXYK(:,:,:),2));
PXYH=squeeze(mean(pulsesXYH(:,:,:),2));
PXYC=squeeze(mean(pulsesXYI(:,:,:),2));

PYYF=squeeze(mean(pulsesYYF(:,:,:),2));
PYYA=squeeze(mean(pulsesYYA(:,:,:),2));
PYYK=squeeze(mean(pulsesYYK(:,:,:),2));
PYYH=squeeze(mean(pulsesYYH(:,:,:),2));
PYYC=squeeze(mean(pulsesYYI(:,:,:),2));

PZYF=squeeze(mean(pulsesZYF(:,:,:),2));
PZYA=squeeze(mean(pulsesZYA(:,:,:),2));
PZYK=squeeze(mean(pulsesZYH(:,:,:),2));
PZYH=squeeze(mean(pulsesZYH(:,:,:),2));
PZYC=squeeze(mean(pulsesZYI(:,:,:),2));

PXYF=PXYF-PXYF(1,:);
PXYA=PXYA-PXYA(1,:);
PXYK=PXYK-PXYK(1,:);
PXYH=PXYH-PXYH(1,:);
PXYC=PXYC-PXYC(1,:);

PYYF=PYYF-PYYF(1,:);
PYYA=PYYA-PYYA(1,:);
PYYK=PYYK-PYYK(1,:);
PYYH=PYYH-PYYH(1,:);
PYYC=PYYC-PYYC(1,:);

PZYF=PZYF-PZYF(1,:);
PZYA=PZYA-PZYA(1,:);
PZYK=PZYK-PZYK(1,:);
PZYH=PZYH-PZYH(1,:);
PZYC=PZYC-PZYC(1,:);

x = 1:15;
xq1 = 0.1:0.1:15;
xq2 = 1:0.1:14.9;


% - - - - - - - Computde the 3D angle

for i=1:Itermice
    for j=1:nbframes+1
        
        
        meanAngle3D_Ankle(j,i)=mean(AnglePulse3D_Ankle(j,1:pulsenumberstart(i)-1,i));
        meanAngle3D_Knee(j,i)=mean(AnglePulse3D_Knee(j,1:pulsenumberstart(i)-1,i));
        meanAngle3D_Hip(j,i)=mean(AnglePulse3D_Hip(j,1:pulsenumberstart(i)-1,i));
        
        meanAngle3DY_Ankle(j,i)=mean(AnglePulse3DY_Ankle(j,1:pulsenumberstart(i)-1,i));
        meanAngle3DY_Knee(j,i)=mean(AnglePulse3DY_Knee(j,1:pulsenumberstart(i)-1,i));
        meanAngle3DY_Hip(j,i)=mean(AnglePulse3DY_Hip(j,1:pulsenumberstart(i)-1,i));
        
    end
end



% - - - - Compute the different parameter for Dynamic phase
% Here the mean

for i=1:Itermice
    
    if Itermice==1
        
        PXMF_M(i)=mean(PXMF(1:end));
        PXYF_M(i)=mean(PXYF(1:end));
        PYMF_M(i)=mean(PYMF(1:end));
        PYYF_M(i)=mean(PYYF(1:end));
        PZMF_M(i)=mean(PZMF(1:end));
        PZYF_M(i)=mean(PZYF(1:end));
        
        PXMA_M(i)=mean(PXMA(1:end));
        PXYA_M(i)=mean(PXYA(1:end));
        PYMA_M(i)=mean(PYMA(1:end));
        PYYA_M(i)=mean(PYYA(1:end));
        PZMA_M(i)=mean(PZMA(1:end));
        PZYA_M(i)=mean(PZYA(1:end));
        
        PXMK_M(i)=mean(PXMK(1:end));
        PXYK_M(i)=mean(PXYK(1:end));
        PYMK_M(i)=mean(PYMK(1:end));
        PYYK_M(i)=mean(PYYK(1:end));
        PZMK_M(i)=mean(PZMK(1:end));
        PZYK_M(i)=mean(PZYK(1:end));
        
        PXMH_M(i)=mean(PXMH(1:end));
        PXYH_M(i)=mean(PXYH(1:end));
        PYMH_M(i)=mean(PYMH(1:end));
        PYYH_M(i)=mean(PYYH(1:end));
        PZMH_M(i)=mean(PZMH(1:end));
        PZYH_M(i)=mean(PZYH(1:end));
        
        PXMC_M(i)=mean(PXMC(1:end));
        PXYC_M(i)=mean(PXYC(1:end));
        PYMC_M(i)=mean(PYMC(1:end));
        PYYC_M(i)=mean(PYYC(1:end));
        PZMC_M(i)=mean(PZMC(1:end));
        PZYC_M(i)=mean(PZYC(1:end));
        
    else
        
        PXMF_M(i)=mean(PXMF(1:end,i));
        PXYF_M(i)=mean(PXYF(1:end,i));
        PYMF_M(i)=mean(PYMF(1:end,i));
        PYYF_M(i)=mean(PYYF(1:end,i));
        PZMF_M(i)=mean(PZMF(1:end,i));
        PZYF_M(i)=mean(PZYF(1:end,i));
        
        PXMA_M(i)=mean(PXMA(1:end,i));
        PXYA_M(i)=mean(PXYA(1:end,i));
        PYMA_M(i)=mean(PYMA(1:end,i));
        PYYA_M(i)=mean(PYYA(1:end,i));
        PZMA_M(i)=mean(PZMA(1:end,i));
        PZYA_M(i)=mean(PZYA(1:end,i));
        
        PXMK_M(i)=mean(PXMK(1:end,i));
        PXYK_M(i)=mean(PXYK(1:end,i));
        PYMK_M(i)=mean(PYMK(1:end,i));
        PYYK_M(i)=mean(PYYK(1:end,i));
        PZMK_M(i)=mean(PZMK(1:end,i));
        PZYK_M(i)=mean(PZYK(1:end,i));
        
        PXMH_M(i)=mean(PXMH(1:end,i));
        PXYH_M(i)=mean(PXYH(1:end,i));
        PYMH_M(i)=mean(PYMH(1:end,i));
        PYYH_M(i)=mean(PYYH(1:end,i));
        PZMH_M(i)=mean(PZMH(1:end,i));
        PZYH_M(i)=mean(PZYH(1:end,i));
        
        PXMC_M(i)=mean(PXMC(1:end,i));
        PXYC_M(i)=mean(PXYC(1:end,i));
        PYMC_M(i)=mean(PYMC(1:end,i));
        PYYC_M(i)=mean(PYYC(1:end,i));
        PZMC_M(i)=mean(PZMC(1:end,i));
        PZYC_M(i)=mean(PZYC(1:end,i));
        
    end
    
end

% - - - -  Participation to the movement low joint

for a=1:Itermice
    
    All_ZM(a)=PZMF_M(a)+PZMA_M(a)+PZMK_M(a)+PZMH_M(a);
    All_ZY(a)=PZYF_M(a)+PZYA_M(a)+PZYK_M(a)+PZYH_M(a);
    
    All_XM(a)=PXMF_M(a)+PXMA_M(a)+PXMK_M(a)+PXMH_M(a);
    All_XY(a)=PXYF_M(a)+PXYA_M(a)+PXYK_M(a)+PXYH_M(a);
    
    All_YM(a)=PYMF_M(a)+PYMA_M(a)+PYMK_M(a)+PYMH_M(a);
    All_YY(a)=PYYF_M(a)+PYYA_M(a)+PYYK_M(a)+PYYH_M(a);
    
    
    ParticipationLowJointZM_thigh_dyn(a)=(abs(PZMK_M(a))+abs(PZMH_M(a)));%/All_ZM(a);
    ParticipationLowJointZM_shank_dyn(a)=(abs(PZMA_M(a))+abs(PZMK_M(a)));%/All_ZM(a);
    ParticipationLowJointZM_foot_dyn(a)=(abs(PZMF_M(a))+abs(PZMA_M(a)));%/All_ZM(a);
    
    ParticipationLowJointZY_thigh_dyn(a)=(abs(PZYK_M(a))+abs(PZYH_M(a)));%/All_ZY(a);
    ParticipationLowJointZY_shank_dyn(a)=(abs(PZYA_M(a))+abs(PZYK_M(a)));%/All_ZY(a);
    ParticipationLowJointZY_foot_dyn(a)=(abs(PZYF_M(a))+abs(PZYA_M(a)));%/All_ZY(a);
    
    
    ParticipationLowJointXM_thigh_dyn(a)=(abs(PXMK_M(a))+abs(PXMH_M(a)));
    ParticipationLowJointXM_shank_dyn(a)=(abs(PXMA_M(a))+abs(PXMK_M(a)));
    ParticipationLowJointXM_foot_dyn(a)=(abs(PXMF_M(a))+abs(PXMA_M(a)));
    
    ParticipationLowJointXY_thigh_dyn(a)=(abs(PXYK_M(a))+abs(PXYH_M(a)));
    ParticipationLowJointXY_shank_dyn(a)=(abs(PXYA_M(a))+abs(PXYK_M(a)));
    ParticipationLowJointXY_foot_dyn(a)=(abs(PXYF_M(a))+abs(PXYA_M(a)));
    
    
    ParticipationLowJointYM_thigh_dyn(a)=(abs(PYMK_M(a))+abs(PYMH_M(a)));
    ParticipationLowJointYM_shank_dyn(a)=(abs(PYMA_M(a))+abs(PYMK_M(a)));
    ParticipationLowJointYM_foot_dyn(a)=(abs(PYMF_M(a))+abs(PYMA_M(a)));
    
    ParticipationLowJointYY_thigh_dyn(a)=(abs(PYYK_M(a))+abs(PYYH_M(a)));
    ParticipationLowJointYY_shank_dyn(a)=(abs(PYYA_M(a))+abs(PYYK_M(a)));
    ParticipationLowJointYY_foot_dyn(a)=(abs(PYYF_M(a))+abs(PYYA_M(a)));
    
end


% - - - - Area under the curve : Energy of the movement

for i=1:Itermice
    
    A_PXMF(i)=trapz(PXMF(:,i))-mean(PXMF(1:5,i));
    A_PXYF(i)=trapz(PXYF(:,i))-mean(PXYF(1:5,i));
    A_PYMF(i)=trapz(PYMF(:,i))-mean(PYMF(1:5,i));
    A_PYYF(i)=trapz(PYYF(:,i))-mean(PYYF(1:5,i));
    A_PZMF(i)=trapz(PZMF(:,i))-mean(PZMF(1:5,i));
    A_PZYF(i)=trapz(PZYF(:,i))-mean(PZYF(1:5,i));
    
    A_PXMA(i)=trapz(PXMA(:,i))-mean(PXMA(1:5,i));
    A_PXYA(i)=trapz(PXYA(:,i))-mean(PXYA(1:5,i));
    A_PYMA(i)=trapz(PYMA(:,i))-mean(PYMA(1:5,i));
    A_PYYA(i)=trapz(PYYA(:,i))-mean(PYYA(1:5,i));
    A_PZMA(i)=trapz(PZMA(:,i))-mean(PZMA(1:5,i));
    A_PZYA(i)=trapz(PZYA(:,i))-mean(PZYA(1:5,i));
    
    A_PXMK(i)=trapz(PXMK(:,i))-mean(PXMK(1:5,i));
    A_PXYK(i)=trapz(PXYK(:,i))-mean(PXYK(1:5,i));
    A_PYMK(i)=trapz(PYMK(:,i))-mean(PYMK(1:5,i));
    A_PYYK(i)=trapz(PYYK(:,i))-mean(PYYK(1:5,i));
    A_PZMK(i)=trapz(PZMK(:,i))-mean(PZMK(1:5,i));
    A_PZYK(i)=trapz(PZYK(:,i))-mean(PZYK(1:5,i));
    
    A_PXMH(i)=trapz(PXMH(:,i))-mean(PXMH(1:5,i));
    A_PXYH(i)=trapz(PXYH(:,i))-mean(PXYH(1:5,i));
    A_PYMH(i)=trapz(PYMH(:,i))-mean(PYMH(1:5,i));
    A_PYYH(i)=trapz(PYYH(:,i))-mean(PYYH(1:5,i));
    A_PZMH(i)=trapz(PZMH(:,i))-mean(PZMH(1:5,i));
    A_PZYH(i)=trapz(PZYH(:,i))-mean(PZYH(1:5,i));
    
    A_PXMC(i)=trapz(PXMC(:,i))-mean(PXMC(1:5,i));
    A_PXYC(i)=trapz(PXYC(:,i))-mean(PXYC(1:5,i));
    A_PYMC(i)=trapz(PYMC(:,i))-mean(PYMC(1:5,i));
    A_PYYC(i)=trapz(PYYC(:,i))-mean(PYYC(1:5,i));
    A_PZMC(i)=trapz(PZMC(:,i))-mean(PZMC(1:5,i));
    A_PZYC(i)=trapz(PZYC(:,i))-mean(PZYC(1:5,i));
end


% - - - - Speed and acceleration


for i=1:Itermice
    
    if Itermice==1
        
        PZMF_speed(1:20,i)=diff(PZMF);
        PZYF_speed(1:20,i)=diff(PYMF);
        PXMF_speed(1:20,i)=diff(PXMF);
        PXYF_speed(1:20,i)=diff(PXMF);
        PYMF_speed(1:20,i)=diff(PYMF);
        PYYF_speed(1:20,i)=diff(PYMF);
        
        PZMA_speed(1:20,i)=diff(PZMA);
        PZYA_speed(1:20,i)=diff(PYMA);
        PXMA_speed(1:20,i)=diff(PXMA);
        PXYA_speed(1:20,i)=diff(PXMA);
        PYMA_speed(1:20,i)=diff(PYMA);
        PYYA_speed(1:20,i)=diff(PYMA);
        
        PZMK_speed(1:20,i)=diff(PZMK);
        PZYK_speed(1:20,i)=diff(PYMK);
        PXMK_speed(1:20,i)=diff(PXMK);
        PXYK_speed(1:20,i)=diff(PXMK);
        PYMK_speed(1:20,i)=diff(PYMK);
        PYYK_speed(1:20,i)=diff(PYMK);
        
        PZMC_speed(1:20,i)=diff(PZMC);
        PZYC_speed(1:20,i)=diff(PYMC);
        PXMC_speed(1:20,i)=diff(PXMC);
        PXYC_speed(1:20,i)=diff(PXMC);
        PYMC_speed(1:20,i)=diff(PYMC);
        PYYC_speed(1:20,i)=diff(PYMC);
        
        PZMH_speed(1:20,i)=diff(PZMH);
        PZYH_speed(1:20,i)=diff(PYMH);
        PXMH_speed(1:20,i)=diff(PXMH);
        PXYH_speed(1:20,i)=diff(PXMH);
        PYMH_speed(1:20,i)=diff(PYMH);
        PYYH_speed(1:20,i)=diff(PYMH);
        
        
        
        PZMF_acc(1:20,i)=diff(PZMF_speed);
        PZYF_acc(1:20,i)=diff(PZYF_speed);
        PXMF_acc(1:20,i)=diff(PXMF_speed);
        PXYF_acc(1:20,i)=diff(PXYF_speed);
        PYMF_acc(1:20,i)=diff(PYMF_speed);
        PYYF_acc(1:20,i)=diff(PYYF_speed);
        
        PZMA_acc(1:20,i)=diff(PZMA_speed);
        PZYA_acc(1:20,i)=diff(PZYA_speed);
        PXMA_acc(1:20,i)=diff(PXMA_speed);
        PXYA_acc(1:20,i)=diff(PXYA_speed);
        PYMA_acc(1:20,i)=diff(PYMA_speed);
        PYYA_acc(1:20,i)=diff(PYYA_speed);
        
        PZMK_acc(1:20,i)=diff(PZMK_speed);
        PZYK_acc(1:20,i)=diff(PZYK_speed);
        PXMK_acc(1:20,i)=diff(PXMK_speed);
        PXYK_acc(1:20,i)=diff(PXYK_speed);
        PYMK_acc(1:20,i)=diff(PYMK_speed);
        PYYK_acc(1:20,i)=diff(PYYK_speed);
        
        PZMC_acc(1:20,i)=diff(PZMC_speed);
        PZYC_acc(1:20,i)=diff(PZYC_speed);
        PXMC_acc(1:20,i)=diff(PXMC_speed);
        PXYC_acc(1:20,i)=diff(PXYC_speed);
        PYMC_acc(1:20,i)=diff(PYMC_speed);
        PYYC_acc(1:20,i)=diff(PYYC_speed);
        
        PZMH_acc(1:20,i)=diff(PZMH_speed);
        PZYH_acc(1:20,i)=diff(PZYH_speed);
        PXMH_acc(1:20,i)=diff(PXMH_speed);
        PXYH_acc(1:20,i)=diff(PXYH_speed);
        PYMH_acc(1:20,i)=diff(PYMH_speed);
        PYYH_acc(1:20,i)=diff(PYYH_speed);
        
        
        
        
    else
        
        PZMF_speed(1:20,i)=diff(PZMF(:,i));
        PZYF_speed(1:20,i)=diff(PYMF(:,i));
        PXMF_speed(1:20,i)=diff(PXMF(:,i));
        PXYF_speed(1:20,i)=diff(PXMF(:,i));
        PYMF_speed(1:20,i)=diff(PYMF(:,i));
        PYYF_speed(1:20,i)=diff(PYMF(:,i));
        
        PZMA_speed(1:20,i)=diff(PZMA(:,i));
        PZYA_speed(1:20,i)=diff(PYMA(:,i));
        PXMA_speed(1:20,i)=diff(PXMA(:,i));
        PXYA_speed(1:20,i)=diff(PXMA(:,i));
        PYMA_speed(1:20,i)=diff(PYMA(:,i));
        PYYA_speed(1:20,i)=diff(PYMA(:,i));
        
        PZMK_speed(1:20,i)=diff(PZMK(:,i));
        PZYK_speed(1:20,i)=diff(PYMK(:,i));
        PXMK_speed(1:20,i)=diff(PXMK(:,i));
        PXYK_speed(1:20,i)=diff(PXMK(:,i));
        PYMK_speed(1:20,i)=diff(PYMK(:,i));
        PYYK_speed(1:20,i)=diff(PYMK(:,i));
        
        PZMC_speed(1:20,i)=diff(PZMC(:,i));
        PZYC_speed(1:20,i)=diff(PYMC(:,i));
        PXMC_speed(1:20,i)=diff(PXMC(:,i));
        PXYC_speed(1:20,i)=diff(PXMC(:,i));
        PYMC_speed(1:20,i)=diff(PYMC(:,i));
        PYYC_speed(1:20,i)=diff(PYMC(:,i));
        
        PZMH_speed(1:20,i)=diff(PZMH(:,i));
        PZYH_speed(1:20,i)=diff(PYMH(:,i));
        PXMH_speed(1:20,i)=diff(PXMH(:,i));
        PXYH_speed(1:20,i)=diff(PXMH(:,i));
        PYMH_speed(1:20,i)=diff(PYMH(:,i));
        PYYH_speed(1:20,i)=diff(PYMH(:,i));
        
        
        
        PZMF_acc(1:19,i)=diff(PZMF_speed(:,i));
        PZYF_acc(1:19,i)=diff(PZYF_speed(:,i));
        PXMF_acc(1:19,i)=diff(PXMF_speed(:,i));
        PXYF_acc(1:19,i)=diff(PXYF_speed(:,i));
        PYMF_acc(1:19,i)=diff(PYMF_speed(:,i));
        PYYF_acc(1:19,i)=diff(PYYF_speed(:,i));
        
        PZMA_acc(1:19,i)=diff(PZMA_speed(:,i));
        PZYA_acc(1:19,i)=diff(PZYA_speed(:,i));
        PXMA_acc(1:19,i)=diff(PXMA_speed(:,i));
        PXYA_acc(1:19,i)=diff(PXYA_speed(:,i));
        PYMA_acc(1:19,i)=diff(PYMA_speed(:,i));
        PYYA_acc(1:19,i)=diff(PYYA_speed(:,i));
        
        PZMK_acc(1:19,i)=diff(PZMK_speed(:,i));
        PZYK_acc(1:19,i)=diff(PZYK_speed(:,i));
        PXMK_acc(1:19,i)=diff(PXMK_speed(:,i));
        PXYK_acc(1:19,i)=diff(PXYK_speed(:,i));
        PYMK_acc(1:19,i)=diff(PYMK_speed(:,i));
        PYYK_acc(1:19,i)=diff(PYYK_speed(:,i));
        
        PZMC_acc(1:19,i)=diff(PZMC_speed(:,i));
        PZYC_acc(1:19,i)=diff(PZYC_speed(:,i));
        PXMC_acc(1:19,i)=diff(PXMC_speed(:,i));
        PXYC_acc(1:19,i)=diff(PXYC_speed(:,i));
        PYMC_acc(1:19,i)=diff(PYMC_speed(:,i));
        PYYC_acc(1:19,i)=diff(PYYC_speed(:,i));
        
        PZMH_acc(1:19,i)=diff(PZMH_speed(:,i));
        PZYH_acc(1:19,i)=diff(PZYH_speed(:,i));
        PXMH_acc(1:19,i)=diff(PXMH_speed(:,i));
        PXYH_acc(1:19,i)=diff(PXYH_speed(:,i));
        PYMH_acc(1:19,i)=diff(PYMH_speed(:,i));
        PYYH_acc(1:19,i)=diff(PYYH_speed(:,i));
        
    end
end

% - - - Amplitude


for i=1:Itermice
    
    meanAmpPulseZMF(i)=max(PZMF(10:20,i))-mean(PZMF(1:10,i));
    meanAmpPulseZYF(i)=max(PZYF(10:20,i))-mean(PZYF(1:10,i));
    meanAmpPulseXMF(i)=max(PXMF(10:20,i))-mean(PXMF(1:10,i));
    meanAmpPulseXYF(i)=max(PXYF(10:20,i))-mean(PXYF(1:10,i));
    meanAmpPulseYMF(i)=max(PYMF(10:20,i))-mean(PYMF(1:10,i));
    meanAmpPulseYYF(i)=max(PYYF(10:20,i))-mean(PYYF(1:10,i));
    
    meanAmpPulseZMA(i)=max(PZMA(10:20,i))-mean(PZMA(1:10,i));
    meanAmpPulseZYA(i)=max(PZYA(10:20,i))-mean(PZYA(1:10,i));
    meanAmpPulseXMA(i)=max(PXMA(10:20,i))-mean(PXMA(1:10,i));
    meanAmpPulseXYA(i)=max(PXYA(10:20,i))-mean(PXYA(1:10,i));
    meanAmpPulseYMA(i)=max(PYMA(10:20,i))-mean(PYMA(1:10,i));
    meanAmpPulseYYA(i)=max(PYYA(10:20,i))-mean(PYYA(1:10,i));
    
    meanAmpPulseZMK(i)=max(PZMK(10:20,i))-mean(PZMK(1:10,i));
    meanAmpPulseZYK(i)=max(PZYK(10:20,i))-mean(PZYK(1:10,i));
    meanAmpPulseXMK(i)=max(PXMK(10:20,i))-mean(PXMK(1:10,i));
    meanAmpPulseXYK(i)=max(PXYK(10:20,i))-mean(PXYK(1:10,i));
    meanAmpPulseYMK(i)=max(PYMK(10:20,i))-mean(PYMK(1:10,i));
    meanAmpPulseYYK(i)=max(PYYK(10:20,i))-mean(PYYK(1:10,i));
    
    meanAmpPulseZMH(i)=max(PZMH(10:20,i))-mean(PZMH(1:10,i));
    meanAmpPulseZYH(i)=max(PZYH(10:20,i))-mean(PZYH(1:10,i));
    meanAmpPulseXMH(i)=max(PXMH(10:20,i))-mean(PXMH(1:10,i));
    meanAmpPulseXYH(i)=max(PXYH(10:20,i))-mean(PXYH(1:10,i));
    meanAmpPulseYMH(i)=max(PYMH(10:20,i))-mean(PYMH(1:10,i));
    meanAmpPulseYYH(i)=max(PYYH(10:20,i))-mean(PYYH(1:10,i));
    
    meanAmpPulseZMI(i)=max(PZMC(10:20,i))-mean(PZMC(1:10,i));
    meanAmpPulseZYI(i)=max(PZYC(10:20,i))-mean(PZYC(1:10,i));
    meanAmpPulseXMI(i)=max(PXMC(10:20,i))-mean(PXMC(1:10,i));
    meanAmpPulseXYI(i)=max(PXYC(10:20,i))-mean(PXYC(1:10,i));
    meanAmpPulseYMI(i)=max(PYMC(10:20,i))-mean(PYMC(1:10,i));
    meanAmpPulseYYI(i)=max(PYYC(10:20,i))-mean(PYYC(1:10,i));
    
    Angle3D_Ankle(i)=max(meanAngle3D_Ankle(5:end,i))-min(meanAngle3D_Ankle(5:end,i));
    Angle3D_Knee(i)=max(meanAngle3D_Knee(5:end,i))-min(meanAngle3D_Knee(5:end,i));
    Angle3D_Hip(i)=max(meanAngle3D_Hip(5:end,i))-min(meanAngle3D_Hip(5:end,i));
    
    Angle3DY_Ankle(i)=max(meanAngle3DY_Ankle(5:end,i))-min(meanAngle3DY_Ankle(5:end,i));
    Angle3DY_Knee(i)=max(meanAngle3DY_Knee(5:end,i))-min(meanAngle3DY_Knee(5:end,i));
    Angle3DY_Hip(i)=max(meanAngle3DY_Hip(5:end,i))-min(meanAngle3DY_Hip(5:end,i));
    
    
    
    
    meanDiffAmpPulseZMF(i)=mean(PZMF_speed(5:end,i));
    meanDiffAmpPulseZYF(i)=mean(PZYF_speed(5:end,i));
    meanDiffAmpPulseXMF(i)=mean(PXMF_speed(5:end,i));
    meanDiffAmpPulseXYF(i)=mean(PXYF_speed(5:end,i));
    meanDiffAmpPulseYMF(i)=mean(PYMF_speed(5:end,i));
    meanDiffAmpPulseYYF(i)=mean(PYYF_speed(5:end,i));
    
    meanDiffAmpPulseZMA(i)=mean(PZMA_speed(5:end,i));
    meanDiffAmpPulseZYA(i)=mean(PZYA_speed(5:end,i));
    meanDiffAmpPulseXMA(i)=mean(PXMA_speed(5:end,i));
    meanDiffAmpPulseXYA(i)=mean(PXYA_speed(5:end,i));
    meanDiffAmpPulseYMA(i)=mean(PYMA_speed(5:end,i));
    meanDiffAmpPulseYYA(i)=mean(PYYA_speed(5:end,i));
    
    meanDiffAmpPulseZMK(i)=mean(PZMK_speed(5:end,i));
    meanDiffAmpPulseZYK(i)=mean(PZYK_speed(5:end,i));
    meanDiffAmpPulseXMK(i)=mean(PXMK_speed(5:end,i));
    meanDiffAmpPulseXYK(i)=mean(PXYK_speed(5:end,i));
    meanDiffAmpPulseYMK(i)=mean(PYMK_speed(5:end,i));
    meanDiffAmpPulseYYK(i)=mean(PYYK_speed(5:end,i));
    
    meanDiffAmpPulseZMH(i)=mean(PZMH_speed(5:end,i));
    meanDiffAmpPulseZYH(i)=mean(PZYH_speed(5:end,i));
    meanDiffAmpPulseXMH(i)=mean(PXMH_speed(5:end,i));
    meanDiffAmpPulseXYH(i)=mean(PXYH_speed(5:end,i));
    meanDiffAmpPulseYMH(i)=mean(PYMH_speed(5:end,i));
    meanDiffAmpPulseYYH(i)=mean(PYYH_speed(5:end,i));
    
    meanDiffAmpPulseZMI(i)=mean(PZMC_speed(5:end,i));
    meanDiffAmpPulseZYI(i)=mean(PZYC_speed(5:end,i));
    meanDiffAmpPulseXMI(i)=mean(PXMC_speed(5:end,i));
    meanDiffAmpPulseXYI(i)=mean(PXYC_speed(5:end,i));
    meanDiffAmpPulseYMI(i)=mean(PYMC_speed(5:end,i));
    meanDiffAmpPulseYYI(i)=mean(PYYC_speed(5:end,i));
    
    
    [Mu Iu]=max(PZMF(:,i));
    [Md Id]=min(PZMF(Iu:end,i));
    MaxPeakPZMF(i)=500*Iu/150;
    MinPeakPZMF(i)=500*(Id+Iu)/150;
    EndpointPZMF(i)=Mu-Md;
    
    [Mu Iu]=max(PZMA(:,i));
    [Md Id]=min(PZMA(Iu:end,i));
    MaxPeakPZMA(i)=500*Iu/150;
    MinPeakPZMA(i)=500*(Id+Iu)/150;
    EndpointPZMA(i)=Mu-Md;
    
    [Mu Iu]=max(PZMK(:,i));
    [Md Id]=min(PZMK(Iu:end,i));
    MaxPeakPZMK(i)=500*Iu/150;
    MinPeakPZMK(i)=500*(Id+Iu)/150;
    EndpointPZMK(i)=Mu-Md;
    
    [Mu Iu]=max(PZMH(:,i));
    [Md Id]=min(PZMH(Iu:end,i));
    MaxPeakPZMH(i)=500*Iu/150;
    MinPeakPZMH(i)=500*(Id+Iu)/150;
    EndpointPZMH(i)=Mu-Md;
    
    [Mu Iu]=max(PZMC(:,i));
    [Md Id]=min(PZMC(Iu:end,i));
    MaxPeakPZMC(i)=500*Iu/150;
    MinPeakPZMC(i)=500*(Id+Iu)/150;
    EndpointPZMC(i)=Mu-Md;
    
    [Mu Iu]=max(PZYF(:,i));
    [Md Id]=min(PZYF(Iu:end,i));
    MaxPeakPZYF(i)=500*Iu/150;
    MinPeakPZYF(i)=500*(Id+Iu)/150;
    EndpointPZYF(i)=Mu-Md;
    
    [Mu Iu]=max(PZYA(:,i));
    [Md Id]=min(PZYA(Iu:end,i));
    MaxPeakPZYA(i)=500*Iu/150;
    MinPeakPZYA(i)=500*(Id+Iu)/150;
    EndpointPZYA(i)=Mu-Md;
    
    [Mu Iu]=max(PZYK(:,i));
    [Md Id]=min(PZYK(Iu:end,i));
    MaxPeakPZYK(i)=500*Iu/150;
    MinPeakPZYK(i)=500*(Id+Iu)/150;
    EndpointPZYK(i)=Mu-Md;
    
    [Mu Iu]=max(PZYH(:,i));
    [Md Id]=min(PZYH(Iu:end,i));
    MaxPeakPZYH(i)=500*Iu/150;
    MinPeakPZYH(i)=500*(Id+Iu)/150;
    EndpointPZYH(i)=Mu-Md;
    
    [Mu Iu]=max(PZYC(:,i));
    [Md Id]=min(PZYC(Iu:end,i));
    MaxPeakPZYC(i)=500*Iu/150;
    MinPeakPZYC(i)=500*(Id+Iu)/150;
    EndpointPZYC(i)=Mu-Md;
    
end






%%
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % %
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % %
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % %
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % %

% - - - FILL THE TABLE FOR THE PCA

% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % %
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % %
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % %
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % %


PCAtab=cell(Itermice*2,54);

PCAtab{1,1}='STATUS';
PCAtab{1,2}='DAY';
PCAtab{1,3}='PAIR';

Ndays(nnz(Ndays))=1;

% STATUS
for i=1:Itermice
    PCAtab{i+1,1}=1;
    PCAtab{i+1+Itermice,1}=0;
end


% DAY
a=2;
for i=1:Ndays(nnz(Ndays))
    for j=1:nnz(Npairs(i,:))
        
        PCAtab{a,2}=i;
        PCAtab{a+Itermice,2}=i;
        a=a+1;
        
    end
end

% PAIR
a=2;
for i=1:Ndays(nnz(Ndays))
    for j=1:nnz(Npairs(i,:))
        
        PCAtab{a,3}=Npairs(i,j);
        PCAtab{a+Itermice,3}=Npairs(i,j);
        a=a+1;
        
    end
end

Ndays(nnz(Ndays))=1;


% CONTROL
PCAtab{1,4}='Control';
a=2;
for i=1:Ndays(nnz(Ndays))
    for j=1:nnz(Npairs(i,:))
        
        PCAtab{a,4}=ControlFootPos(a-1);
        PCAtab{a+Itermice,4}=ControlFootPosY(a-1);
        a=a+1;
        
    end
end
Col=4;

% TIME SPEND UNDER THE THRESHOLD
for fold = 1
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='Percentage_time_spend_under_the_threshold';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(PercentageTimeBeingS(a-1));
            PCAtab{a+Itermice,Col}=+(PercentageTimeBeingSY(a-1));
            a=a+1;
            
        end
    end
    
end





% MEAN GLOBAL MOVEMENT
for fold = 1
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='MeanGlobal_XF';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(MeanXM(a-1,Joint));
            PCAtab{a+Itermice,Col}=+(MeanXY(a-1,Joint));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=2;
    PCAtab{1,Col}='MeanGlobal_XA';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(MeanXM(a-1,Joint));
            PCAtab{a+Itermice,Col}=+(MeanXY(a-1,Joint));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=3;
    PCAtab{1,Col}='MeanGlobal_XK';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(MeanXM(a-1,Joint));
            PCAtab{a+Itermice,Col}=+(MeanXY(a-1,Joint));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=4;
    PCAtab{1,Col}='MeanGlobal_XH';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(MeanXM(a-1,Joint));
            PCAtab{a+Itermice,Col}=+(MeanXY(a-1,Joint));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=5;
    PCAtab{1,Col}='MeanGlobal_XI';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(MeanXM(a-1,Joint));
            PCAtab{a+Itermice,Col}=+(MeanXY(a-1,Joint));
            a=a+1;
            
        end
    end
    
    % MEAN Y
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='MeanGlobal_YF';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(MeanYM(a-1,Joint));
            PCAtab{a+Itermice,Col}=+(MeanYY(a-1,Joint));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=2;
    PCAtab{1,Col}='MeanGlobal_YA';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(MeanYM(a-1,Joint));
            PCAtab{a+Itermice,Col}=+(MeanYY(a-1,Joint));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=3;
    PCAtab{1,Col}='MeanGlobal_YK';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(MeanYM(a-1,Joint));
            PCAtab{a+Itermice,Col}=+(MeanYY(a-1,Joint));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=4;
    PCAtab{1,Col}='MeanGlobal_YH';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(MeanYM(a-1,Joint));
            PCAtab{a+Itermice,Col}=+(MeanYY(a-1,Joint));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=5;
    PCAtab{1,Col}='MeanGlobal_YI';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(MeanYM(a-1,Joint));
            PCAtab{a+Itermice,Col}=+(MeanYY(a-1,Joint));
            a=a+1;
            
        end
    end
    
    % MEAN Z
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='MeanGlobal_ZF';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(MeanZM(a-1,Joint));
            PCAtab{a+Itermice,Col}=+(MeanZY(a-1,Joint));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=2;
    PCAtab{1,Col}='MeanGlobal_ZA';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(MeanZM(a-1,Joint));
            PCAtab{a+Itermice,Col}=+(MeanZY(a-1,Joint));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=3;
    PCAtab{1,Col}='MeanGlobal_ZK';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(MeanZM(a-1,Joint));
            PCAtab{a+Itermice,Col}=+(MeanZY(a-1,Joint));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=4;
    PCAtab{1,Col}='MeanGlobal_ZH';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(MeanZM(a-1,Joint));
            PCAtab{a+Itermice,Col}=+(MeanZY(a-1,Joint));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=5;
    PCAtab{1,Col}='MeanGlobal_ZI';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(MeanZM(a-1,Joint));
            PCAtab{a+Itermice,Col}=+(MeanZY(a-1,Joint));
            a=a+1;
            
        end
    end
end

% ANGLE 3D MEAN
for fold = 1
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='Angle_3D_Ankle';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(MeanAngle3D(a-1,Joint));
            PCAtab{a+Itermice,Col}=+(MeanAngle3DY(a-1,Joint));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=2;
    PCAtab{1,Col}='Angle_3D_Knee';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(MeanAngle3D(a-1,Joint));
            PCAtab{a+Itermice,Col}=+(MeanAngle3DY(a-1,Joint));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=3;
    PCAtab{1,Col}='Angle_3D_Hip';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(MeanAngle3D(a-1,Joint));
            PCAtab{a+Itermice,Col}=+(MeanAngle3DY(a-1,Joint));
            a=a+1;
            
        end
    end
    
end

% STD GLOBAL MOVEMENT
for fold = 1
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='StdGlobal_XF';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(StdXM(a-1,Joint));
            PCAtab{a+Itermice,Col}=+(StdXY(a-1,Joint));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=2;
    PCAtab{1,Col}='StdGlobal_XA';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(StdXM(a-1,Joint));
            PCAtab{a+Itermice,Col}=+(StdXY(a-1,Joint));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=3;
    PCAtab{1,Col}='StdGlobal_XK';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(StdXM(a-1,Joint));
            PCAtab{a+Itermice,Col}=+(StdXY(a-1,Joint));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=4;
    PCAtab{1,Col}='StdGlobal_XH';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(StdXM(a-1,Joint));
            PCAtab{a+Itermice,Col}=+(StdXY(a-1,Joint));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=5;
    PCAtab{1,Col}='StdGlobal_XI';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(StdXM(a-1,Joint));
            PCAtab{a+Itermice,Col}=+(StdXY(a-1,Joint));
            a=a+1;
            
        end
    end
    
    % STD Y
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='StdGlobal_YF';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(StdYM(a-1,Joint));
            PCAtab{a+Itermice,Col}=+(StdYY(a-1,Joint));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=2;
    PCAtab{1,Col}='StdGlobal_YA';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(StdYM(a-1,Joint));
            PCAtab{a+Itermice,Col}=+(StdYY(a-1,Joint));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=3;
    PCAtab{1,Col}='StdGlobal_YK';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(StdYM(a-1,Joint));
            PCAtab{a+Itermice,Col}=+(StdYY(a-1,Joint));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=4;
    PCAtab{1,Col}='StdGlobal_YH';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(StdYM(a-1,Joint));
            PCAtab{a+Itermice,Col}=+(StdYY(a-1,Joint));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=5;
    PCAtab{1,Col}='StdGlobal_YI';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(StdYM(a-1,Joint));
            PCAtab{a+Itermice,Col}=+(StdYY(a-1,Joint));
            a=a+1;
            
        end
    end
    
    % STD Z
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='StdGlobal_ZF';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(StdZM(a-1,Joint));
            PCAtab{a+Itermice,Col}=+(StdZY(a-1,Joint));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=2;
    PCAtab{1,Col}='StdGlobal_ZA';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(StdZM(a-1,Joint));
            PCAtab{a+Itermice,Col}=+(StdZY(a-1,Joint));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=3;
    PCAtab{1,Col}='StdGlobal_ZK';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(StdZM(a-1,Joint));
            PCAtab{a+Itermice,Col}=+(StdZY(a-1,Joint));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=4;
    PCAtab{1,Col}='StdGlobal_ZH';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(StdZM(a-1,Joint));
            PCAtab{a+Itermice,Col}=+(StdZY(a-1,Joint));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=5;
    PCAtab{1,Col}='StdGlobal_ZI';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(StdZM(a-1,Joint));
            PCAtab{a+Itermice,Col}=+(StdZY(a-1,Joint));
            a=a+1;
            
        end
    end
end

% AMP GLOBAL MOVEMENT
for fold = 1
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='AmpGlobal_XF';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(AmpXM(a-1,Joint));
            PCAtab{a+Itermice,Col}=+(AmpXY(a-1,Joint));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=2;
    PCAtab{1,Col}='AmpGlobal_XA';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(AmpXM(a-1,Joint));
            PCAtab{a+Itermice,Col}=+(AmpXY(a-1,Joint));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=3;
    PCAtab{1,Col}='AmpGlobal_XK';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(AmpXM(a-1,Joint));
            PCAtab{a+Itermice,Col}=+(AmpXY(a-1,Joint));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=4;
    PCAtab{1,Col}='AmpGlobal_XH';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(AmpXM(a-1,Joint));
            PCAtab{a+Itermice,Col}=+(AmpXY(a-1,Joint));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=5;
    PCAtab{1,Col}='AmpGlobal_XI';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(AmpXM(a-1,Joint));
            PCAtab{a+Itermice,Col}=+(AmpXY(a-1,Joint));
            a=a+1;
            
        end
    end
    
    % AMP Y
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='AmpGlobal_YF';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(AmpYM(a-1,Joint));
            PCAtab{a+Itermice,Col}=+(AmpYY(a-1,Joint));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=2;
    PCAtab{1,Col}='AmpGlobal_YA';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(AmpYM(a-1,Joint));
            PCAtab{a+Itermice,Col}=+(AmpYY(a-1,Joint));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=3;
    PCAtab{1,Col}='AmpGlobal_YK';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(AmpYM(a-1,Joint));
            PCAtab{a+Itermice,Col}=+(AmpYY(a-1,Joint));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=4;
    PCAtab{1,Col}='AmpGlobal_YH';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(AmpYM(a-1,Joint));
            PCAtab{a+Itermice,Col}=+(AmpYY(a-1,Joint));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=5;
    PCAtab{1,Col}='AmpGlobal_YI';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(AmpYM(a-1,Joint));
            PCAtab{a+Itermice,Col}=+(AmpYY(a-1,Joint));
            a=a+1;
            
        end
    end
    
    % AMP Z
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='AmpGlobal_ZF';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(AmpZM(a-1,Joint));
            PCAtab{a+Itermice,Col}=+(AmpZY(a-1,Joint));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=2;
    PCAtab{1,Col}='AmpGlobal_ZA';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(AmpZM(a-1,Joint));
            PCAtab{a+Itermice,Col}=+(AmpZY(a-1,Joint));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=3;
    PCAtab{1,Col}='AmpGlobal_ZK';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(AmpZM(a-1,Joint));
            PCAtab{a+Itermice,Col}=+(AmpZY(a-1,Joint));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=4;
    PCAtab{1,Col}='AmpGlobal_ZH';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(AmpZM(a-1,Joint));
            PCAtab{a+Itermice,Col}=+(AmpZY(a-1,Joint));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=5;
    PCAtab{1,Col}='AmpGlobal_ZI';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(AmpZM(a-1,Joint));
            PCAtab{a+Itermice,Col}=+(AmpZY(a-1,Joint));
            a=a+1;
            
        end
    end
end

% PARTICIPATION LOW JOINT
for fold = 1
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='ParticipationLowJoint_X_Thigh';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(ParticipationLowJointXM_thigh(a-1));
            PCAtab{a+Itermice,Col}=+(ParticipationLowJointXY_thigh(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='ParticipationLowJoint_X_Shank';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(ParticipationLowJointXM_shank(a-1));
            PCAtab{a+Itermice,Col}=+(ParticipationLowJointXY_shank(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='ParticipationLowJoint_X_Foot';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(ParticipationLowJointXM_foot(a-1));
            PCAtab{a+Itermice,Col}=+(ParticipationLowJointXM_foot(a-1));
            a=a+1;
            
        end
    end
    
    
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='ParticipationLowJoint_Y_Thigh';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(ParticipationLowJointYM_thigh(a-1));
            PCAtab{a+Itermice,Col}=+(ParticipationLowJointYY_thigh(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='ParticipationLowJoint_Y_Shank';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(ParticipationLowJointYM_shank(a-1));
            PCAtab{a+Itermice,Col}=+(ParticipationLowJointYY_shank(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='ParticipationLowJoint_Y_Foot';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(ParticipationLowJointYM_foot(a-1));
            PCAtab{a+Itermice,Col}=+(ParticipationLowJointYM_foot(a-1));
            a=a+1;
            
        end
    end
    
    
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='ParticipationLowJoint_Z_Thigh';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(ParticipationLowJointZM_thigh(a-1));
            PCAtab{a+Itermice,Col}=+(ParticipationLowJointZY_thigh(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='ParticipationLowJoint_Z_Shank';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(ParticipationLowJointZM_shank(a-1));
            PCAtab{a+Itermice,Col}=+(ParticipationLowJointZY_shank(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='ParticipationLowJoint_Z_Foot';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(ParticipationLowJointZM_foot(a-1));
            PCAtab{a+Itermice,Col}=+(ParticipationLowJointZY_foot(a-1));
            a=a+1;
            
        end
    end
    
end




%Speed
for fold = 1
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='Speed_XF';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=speedXM(a-1,Joint);
            %(ParticipationLowJointXM_thigh(a-1));
            PCAtab{a+Itermice,Col}=speedXY(a-1,Joint);
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=2;
    PCAtab{1,Col}='Speed_XA';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=speedXM(a-1,Joint);
            %(ParticipationLowJointXM_thigh(a-1));
            PCAtab{a+Itermice,Col}=speedXY(a-1,Joint);
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=3;
    PCAtab{1,Col}='Speed_XK';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=speedXM(a-1,Joint);
            %(ParticipationLowJointXM_thigh(a-1));
            PCAtab{a+Itermice,Col}=speedXY(a-1,Joint);
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=4;
    PCAtab{1,Col}='Speed_XH';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=speedXM(a-1,Joint);
            %(ParticipationLowJointXM_thigh(a-1));
            PCAtab{a+Itermice,Col}=speedXY(a-1,Joint);
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=5;
    PCAtab{1,Col}='Speed_XC';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=speedXM(a-1,Joint);
            %(ParticipationLowJointXM_thigh(a-1));
            PCAtab{a+Itermice,Col}=speedXY(a-1,Joint);
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='Speed_YF';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=speedYM(a-1,Joint);
            %(ParticipationLowJointXM_thigh(a-1));
            PCAtab{a+Itermice,Col}=speedYY(a-1,Joint);
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=2;
    PCAtab{1,Col}='Speed_YA';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=speedYM(a-1,Joint);
            %(ParticipationLowJointXM_thigh(a-1));
            PCAtab{a+Itermice,Col}=speedYY(a-1,Joint);
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=3;
    PCAtab{1,Col}='Speed_YK';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=speedYM(a-1,Joint);
            %(ParticipationLowJointXM_thigh(a-1));
            PCAtab{a+Itermice,Col}=speedYY(a-1,Joint);
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=4;
    PCAtab{1,Col}='Speed_YH';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=speedYM(a-1,Joint);
            %(ParticipationLowJointXM_thigh(a-1));
            PCAtab{a+Itermice,Col}=speedYY(a-1,Joint);
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=5;
    PCAtab{1,Col}='Speed_YC';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=speedYM(a-1,Joint);
            %(ParticipationLowJointXM_thigh(a-1));
            PCAtab{a+Itermice,Col}=speedYY(a-1,Joint);
            a=a+1;
            
        end
    end
    
    
    
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='Speed_ZF';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=speedZM(a-1,Joint);
            %(ParticipationLowJointXM_thigh(a-1));
            PCAtab{a+Itermice,Col}=speedZY(a-1,Joint);
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=2;
    PCAtab{1,Col}='Speed_ZA';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=speedZM(a-1,Joint);
            %(ParticipationLowJointXM_thigh(a-1));
            PCAtab{a+Itermice,Col}=speedZY(a-1,Joint);
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=3;
    PCAtab{1,Col}='Speed_ZK';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=speedZM(a-1,Joint);
            %(ParticipationLowJointXM_thigh(a-1));
            PCAtab{a+Itermice,Col}=speedZY(a-1,Joint);
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=4;
    PCAtab{1,Col}='Speed_ZH';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=speedZM(a-1,Joint);
            %(ParticipationLowJointXM_thigh(a-1));
            PCAtab{a+Itermice,Col}=speedZY(a-1,Joint);
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=5;
    PCAtab{1,Col}='Speed_ZC';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=speedZM(a-1,Joint);
            %(ParticipationLowJointXM_thigh(a-1));
            PCAtab{a+Itermice,Col}=speedZY(a-1,Joint);
            a=a+1;
            
        end
    end
    
    
end



%Area under the curve steady
for fold = 1
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='AreaUnder_XF';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            %PCAtab{a,Col}=trapz(XMmean10(j,:,Joint)-XMmean10(j,1,Joint));
            PCAtab{a,Col}=trapz(XM(1:18000,j,Joint)-mean(XM(1:300,j,Joint)));
            PCAtab{a+Itermice,Col}=trapz(XY(1:18000,j,Joint)-mean(XY(1:300,j,Joint)));
            %(ParticipationLowJointXM_thigh(a-1));
            %PCAtab{a+Itermice,Col}=trapz(XYmean10(j,:,Joint)-XYmean10(j,1,Joint));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=2;
    PCAtab{1,Col}='AreaUnder_XA';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            %PCAtab{a,Col}=trapz(XMmean10(j,:,Joint)-XMmean10(j,1,Joint));
            %(ParticipationLowJointXM_thigh(a-1));
            %PCAtab{a+Itermice,Col}=trapz(XYmean10(j,:,Joint)-XYmean10(j,1,Joint));
            PCAtab{a,Col}=trapz(XM(1:18000,j,Joint)-mean(XM(1:300,j,Joint)));
            PCAtab{a+Itermice,Col}=trapz(XY(1:18000,j,Joint)-mean(XY(1:300,j,Joint)));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=3;
    PCAtab{1,Col}='AreaUnder_XK';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            %PCAtab{a,Col}=trapz(XMmean10(j,:,Joint)-XMmean10(j,1,Joint));
            %(ParticipationLowJointXM_thigh(a-1));
            %PCAtab{a+Itermice,Col}=trapz(XYmean10(j,:,Joint)-XYmean10(j,1,Joint));
            PCAtab{a,Col}=trapz(XM(1:18000,j,Joint)-mean(XM(1:300,j,Joint)));
            PCAtab{a+Itermice,Col}=trapz(XY(1:18000,j,Joint)-mean(XY(1:300,j,Joint)));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=4;
    PCAtab{1,Col}='AreaUnder_XH';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            %PCAtab{a,Col}=trapz(XMmean10(j,:,Joint)-XMmean10(j,1,Joint));
            %(ParticipationLowJointXM_thigh(a-1));
            %PCAtab{a+Itermice,Col}=trapz(XMmean10(j,:,Joint)-XYmean10(j,1,Joint));
            PCAtab{a,Col}=trapz(XM(1:18000,j,Joint)-mean(XM(1:300,j,Joint)));
            PCAtab{a+Itermice,Col}=trapz(XY(1:18000,j,Joint)-mean(XY(1:300,j,Joint)));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=5;
    PCAtab{1,Col}='AreaUnder_XC';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            %PCAtab{a,Col}=trapz(XMmean10(j,:,Joint)-XMmean10(j,1,Joint));
            %(ParticipationLowJointXM_thigh(a-1));
            %PCAtab{a+Itermice,Col}=trapz(XYmean10(j,:,Joint)-XYmean10(j,1,Joint));
            PCAtab{a,Col}=trapz(XM(1:18000,j,Joint)-mean(XM(1:300,j,Joint)));
            PCAtab{a+Itermice,Col}=trapz(XY(1:18000,j,Joint)-mean(XY(1:300,j,Joint)));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='AreaUnder_YF';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            %PCAtab{a,Col}=trapz(YMmean10(j,:,Joint)-YMmean10(j,1,Joint));
            %(ParticipationLowJointXM_thigh(a-1));
            %PCAtab{a+Itermice,Col}=trapz(YYmean10(j,:,Joint)-YYmean10(j,1,Joint));
            PCAtab{a,Col}=trapz(YM(1:18000,j,Joint)-mean(YM(1:300,j,Joint)));
            PCAtab{a+Itermice,Col}=trapz(YY(1:18000,j,Joint)-mean(YY(1:300,j,Joint)));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=2;
    PCAtab{1,Col}='AreaUnder_YA';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            %PCAtab{a,Col}=trapz(YMmean10(j,:,Joint)-YMmean10(j,1,Joint));
            %(ParticipationLowJointXM_thigh(a-1));
            %PCAtab{a+Itermice,Col}=trapz(YYmean10(j,:,Joint)-YYmean10(j,1,Joint));
            PCAtab{a,Col}=trapz(YM(1:18000,j,Joint)-mean(YM(1:300,j,Joint)));
            PCAtab{a+Itermice,Col}=trapz(YY(1:18000,j,Joint)-mean(YY(1:300,j,Joint)));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=3;
    PCAtab{1,Col}='AreaUnder_YK';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            %PCAtab{a,Col}=trapz(YMmean10(j,:,Joint)-YMmean10(j,1,Joint));
            %(ParticipationLowJointXM_thigh(a-1));
            %PCAtab{a+Itermice,Col}=trapz(YYmean10(j,:,Joint)-YYmean10(j,1,Joint));
            PCAtab{a,Col}=trapz(YM(1:18000,j,Joint)-mean(YM(1:300,j,Joint)));
            PCAtab{a+Itermice,Col}=trapz(YY(1:18000,j,Joint)-mean(YY(1:300,j,Joint)));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=4;
    PCAtab{1,Col}='AreaUnder_YH';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            %PCAtab{a,Col}=trapz(YMmean10(j,:,Joint)-YMmean10(j,1,Joint));
            %(ParticipationLowJointXM_thigh(a-1));
            %PCAtab{a+Itermice,Col}=trapz(YYmean10(j,:,Joint)-YYmean10(j,1,Joint));
            PCAtab{a,Col}=trapz(YM(1:18000,j,Joint)-mean(YM(1:300,j,Joint)));
            PCAtab{a+Itermice,Col}=trapz(YY(1:18000,j,Joint)-mean(YY(1:300,j,Joint)));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=5;
    PCAtab{1,Col}='AreaUnder_YC';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            %PCAtab{a,Col}=trapz(YMmean10(j,:,Joint)-YMmean10(j,1,Joint));
            %(ParticipationLowJointXM_thigh(a-1));
            %PCAtab{a+Itermice,Col}=trapz(YYmean10(j,:,Joint)-YYmean10(j,1,Joint));
            PCAtab{a,Col}=trapz(YM(1:18000,j,Joint)-mean(YM(1:300,j,Joint)));
            PCAtab{a+Itermice,Col}=trapz(YY(1:18000,j,Joint)-mean(YY(1:300,j,Joint)));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='AreaUnder_ZF';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            %PCAtab{a,Col}=trapz(ZMmean10(j,:,Joint)-ZMmean10(j,1,Joint));
            %(ParticipationLowJointXM_thigh(a-1));
            %PCAtab{a+Itermice,Col}=trapz(ZYmean10(j,:,Joint)-ZYmean10(j,1,Joint));
            PCAtab{a,Col}=trapz(ZM(1:18000,j,Joint)-T(j));
            PCAtab{a+Itermice,Col}=trapz(ZY(1:18000,j,Joint)-TY(j));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=2;
    PCAtab{1,Col}='AreaUnder_ZA';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            %PCAtab{a,Col}=trapz(ZMmean10(j,:,Joint)-ZMmean10(j,1,Joint));
            %(ParticipationLowJointXM_thigh(a-1));
            %PCAtab{a+Itermice,Col}=trapz(ZYmean10(j,:,Joint)-ZYmean10(j,1,Joint));
            PCAtab{a,Col}=trapz(ZM(1:18000,j,Joint)-T(j));
            PCAtab{a+Itermice,Col}=trapz(ZY(1:18000,j,Joint)-TY(j));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=3;
    PCAtab{1,Col}='AreaUnder_ZK';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            %PCAtab{a,Col}=trapz(ZMmean10(j,:,Joint)-ZMmean10(j,1,Joint));
            %(ParticipationLowJointXM_thigh(a-1));
            %PCAtab{a+Itermice,Col}=trapz(ZYmean10(j,:,Joint)-ZYmean10(j,1,Joint));
            PCAtab{a,Col}=trapz(ZM(1:18000,j,Joint)-T(j));
            PCAtab{a+Itermice,Col}=trapz(ZY(1:18000,j,Joint)-TY(j));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=4;
    PCAtab{1,Col}='AreaUnder_ZH';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            %PCAtab{a,Col}=trapz(ZMmean10(j,:,Joint)-ZMmean10(j,1,Joint));
            %(ParticipationLowJointXM_thigh(a-1));
            %PCAtab{a+Itermice,Col}=trapz(ZYmean10(j,:,Joint)-ZYmean10(j,1,Joint));
            PCAtab{a,Col}=trapz(ZM(1:18000,j,Joint)-T(j));
            PCAtab{a+Itermice,Col}=trapz(ZY(1:18000,j,Joint)-TY(j));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=5;
    PCAtab{1,Col}='AreaUnder_ZC';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            %PCAtab{a,Col}=trapz(ZMmean10(j,:,Joint)-ZMmean10(j,1,Joint));
            %(ParticipationLowJointXM_thigh(a-1));
            %PCAtab{a+Itermice,Col}=trapz(ZYmean10(j,:,Joint)-ZYmean10(j,1,Joint));
            PCAtab{a,Col}=trapz(ZM(1:18000,j,Joint)-T(j));
            PCAtab{a+Itermice,Col}=trapz(ZY(1:18000,j,Joint)-TY(j));
            a=a+1;
            
        end
    end
    
end


%%
%clc
%for i=1:Itermice
%    [trapz(ZMmean10(i,:)) trapz(ZYmean10(i,:))]
%    [trapz(XMmean10(i,:)) trapz(XYmean10(i,:))]
%    [trapz(YMmean10(i,:)) trapz(YYmean10(i,:))]
%end
%% DYNAMIC PARAMETERS


% AMP SPIKES MOVEMENT
for fold = 1
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='AmpSpikes_XF';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(meanAmpPulseXMF(a-1));
            PCAtab{a+Itermice,Col}=+(meanAmpPulseXYF(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=2;
    PCAtab{1,Col}='AmpSpikes_XA';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(meanAmpPulseXMA(a-1));
            PCAtab{a+Itermice,Col}=+(meanAmpPulseXYA(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=3;
    PCAtab{1,Col}='AmpSpikes_XK';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(meanAmpPulseXMK(a-1));
            PCAtab{a+Itermice,Col}=+(meanAmpPulseXYK(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=4;
    PCAtab{1,Col}='AmpSpikes_XH';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(meanAmpPulseXMH(a-1));
            PCAtab{a+Itermice,Col}=+(meanAmpPulseXYH(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=5;
    PCAtab{1,Col}='AmpSpikes_XI';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(meanAmpPulseXMI(a-1));
            PCAtab{a+Itermice,Col}=+(meanAmpPulseXYI(a-1));
            a=a+1;
            
        end
    end
    
    % MEAN Y
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='AmpSpikes_YF';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(meanAmpPulseYMF(a-1));
            PCAtab{a+Itermice,Col}=+(meanAmpPulseYYF(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=2;
    PCAtab{1,Col}='AmpSpikes_YA';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(meanAmpPulseYMA(a-1));
            PCAtab{a+Itermice,Col}=+(meanAmpPulseYYA(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=3;
    PCAtab{1,Col}='AmpSpikes_YK';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(meanAmpPulseYMK(a-1));
            PCAtab{a+Itermice,Col}=+(meanAmpPulseYYK(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=4;
    PCAtab{1,Col}='AmpSpikes_YH';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(meanAmpPulseYMH(a-1));
            PCAtab{a+Itermice,Col}=+(meanAmpPulseYYH(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=5;
    PCAtab{1,Col}='AmpSpikes_YI';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(meanAmpPulseYMI(a-1));
            PCAtab{a+Itermice,Col}=+(meanAmpPulseYYI(a-1));
            a=a+1;
            
        end
    end
    
    % MEAN Z
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='AmpSpikes_ZF';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(meanAmpPulseZMF(a-1));
            PCAtab{a+Itermice,Col}=+(meanAmpPulseZYF(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=2;
    PCAtab{1,Col}='AmpSpikes_ZA';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(meanAmpPulseZMA(a-1));
            PCAtab{a+Itermice,Col}=+(meanAmpPulseZYA(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=3;
    PCAtab{1,Col}='AmpSpikes_ZK';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(meanAmpPulseZMK(a-1));
            PCAtab{a+Itermice,Col}=+(meanAmpPulseZYK(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=4;
    PCAtab{1,Col}='AmpSpikes_ZH';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(meanAmpPulseZMH(a-1));
            PCAtab{a+Itermice,Col}=+(meanAmpPulseZYH(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=5;
    PCAtab{1,Col}='AmpSpikes_ZI';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(meanAmpPulseZMI(a-1));
            PCAtab{a+Itermice,Col}=+(meanAmpPulseZYI(a-1));
            a=a+1;
            
        end
    end
end
%
% SPEED SPIKES MOVEMENT
for fold = 1
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='SpeedSpikes_XF';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(meanDiffAmpPulseXMF(a-1));
            PCAtab{a+Itermice,Col}=+(meanDiffAmpPulseXYF(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=2;
    PCAtab{1,Col}='SpeedSpikes_XA';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(meanDiffAmpPulseXMA(a-1));
            PCAtab{a+Itermice,Col}=+(meanDiffAmpPulseXYA(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=3;
    PCAtab{1,Col}='SpeedSpikes_XK';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(meanDiffAmpPulseXMK(a-1));
            PCAtab{a+Itermice,Col}=+(meanDiffAmpPulseXYK(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=4;
    PCAtab{1,Col}='SpeedSpikes_XH';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(meanDiffAmpPulseXMH(a-1));
            PCAtab{a+Itermice,Col}=+(meanDiffAmpPulseXYH(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=5;
    PCAtab{1,Col}='SpeedSpikes_XI';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(meanDiffAmpPulseXMI(a-1));
            PCAtab{a+Itermice,Col}=+(meanDiffAmpPulseXYI(a-1));
            a=a+1;
            
        end
    end
    
    % MEAN Y
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='SpeedSpikes_YF';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(meanDiffAmpPulseYMF(a-1));
            PCAtab{a+Itermice,Col}=+(meanDiffAmpPulseYYF(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=2;
    PCAtab{1,Col}='SpeedSpikes_YA';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(meanDiffAmpPulseYMA(a-1));
            PCAtab{a+Itermice,Col}=+(meanDiffAmpPulseYYA(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=3;
    PCAtab{1,Col}='SpeedSpikes_YK';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(meanDiffAmpPulseYMK(a-1));
            PCAtab{a+Itermice,Col}=+(meanDiffAmpPulseYYK(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=4;
    PCAtab{1,Col}='SpeedGlobal_YH';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(meanDiffAmpPulseYMH(a-1));
            PCAtab{a+Itermice,Col}=+(meanDiffAmpPulseYYH(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=5;
    PCAtab{1,Col}='SpeedSpikes_YI';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(meanDiffAmpPulseYMI(a-1));
            PCAtab{a+Itermice,Col}=+(meanDiffAmpPulseYYI(a-1));
            a=a+1;
            
        end
    end
    
    % MEAN Z
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='SpeedSpikes_ZF';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(meanDiffAmpPulseZMF(a-1));
            PCAtab{a+Itermice,Col}=+(meanDiffAmpPulseZYF(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=2;
    PCAtab{1,Col}='SpeedSpikes_ZA';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(meanDiffAmpPulseZMA(a-1));
            PCAtab{a+Itermice,Col}=+(meanDiffAmpPulseZYA(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=3;
    PCAtab{1,Col}='SpeedSpikes_ZK';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(meanDiffAmpPulseZMK(a-1));
            PCAtab{a+Itermice,Col}=+(meanDiffAmpPulseZYK(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=4;
    PCAtab{1,Col}='SpeedSpikes_ZH';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(meanDiffAmpPulseZMH(a-1));
            PCAtab{a+Itermice,Col}=+(meanDiffAmpPulseZYH(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=5;
    PCAtab{1,Col}='SpeedSpikes_ZI';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(meanDiffAmpPulseZMI(a-1));
            PCAtab{a+Itermice,Col}=+(meanDiffAmpPulseZYI(a-1));
            a=a+1;
            
        end
    end
end

% ACC SPIKES MOVEMENT
for fold = 1
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='accSpikes_XF';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(PXMF_acc(a-1));
            PCAtab{a+Itermice,Col}=+(PXYF_acc(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=2;
    PCAtab{1,Col}='accSpikes_XA';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(PXMA_acc(a-1));
            PCAtab{a+Itermice,Col}=+(PXYA_acc(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=3;
    PCAtab{1,Col}='accSpikes_XK';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(PXMK_acc(a-1));
            PCAtab{a+Itermice,Col}=+(PXYK_acc(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=4;
    PCAtab{1,Col}='accSpikes_XH';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(PXMH_acc(a-1));
            PCAtab{a+Itermice,Col}=+(PXYH_acc(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=5;
    PCAtab{1,Col}='accSpikes_XI';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(PXMC_acc(a-1));
            PCAtab{a+Itermice,Col}=+(PXYC_acc(a-1));
            a=a+1;
            
        end
    end
    
    % MEAN Y
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='accSpikes_YF';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(PYMF_acc(a-1));
            PCAtab{a+Itermice,Col}=+(PYYF_acc(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=2;
    PCAtab{1,Col}='accSpikes_YA';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(PYMA_acc(a-1));
            PCAtab{a+Itermice,Col}=+(PYYA_acc(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=3;
    PCAtab{1,Col}='accSpikes_YK';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(PYMK_acc(a-1));
            PCAtab{a+Itermice,Col}=+(PYYK_acc(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=4;
    PCAtab{1,Col}='accSpikes_YH';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(PYMH_acc(a-1));
            PCAtab{a+Itermice,Col}=+(PYYH_acc(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=5;
    PCAtab{1,Col}='accSpikes_YI';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(PYMC_acc(a-1));
            PCAtab{a+Itermice,Col}=+(PYMC_acc(a-1));
            a=a+1;
            
        end
    end
    
    % MEAN Z
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='accSpikes_ZF';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(PZMF_acc(a-1));
            PCAtab{a+Itermice,Col}=+(PZYF_acc(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=2;
    PCAtab{1,Col}='accSpikes_ZA';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(PZMA_acc(a-1));
            PCAtab{a+Itermice,Col}=+(PZYA_acc(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=3;
    PCAtab{1,Col}='accSpikes_ZK';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(PZMK_acc(a-1));
            PCAtab{a+Itermice,Col}=+(PZYK_acc(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=4;
    PCAtab{1,Col}='accSpikes_ZH';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(PZMH_acc(a-1));
            PCAtab{a+Itermice,Col}=+(PZYH_acc(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=5;
    PCAtab{1,Col}='accSpikes_ZI';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(PZMC_acc(a-1));
            PCAtab{a+Itermice,Col}=+(PZYC_acc(a-1));
            a=a+1;
            
        end
    end
end

%Participation dynamique

for fold = 1
    
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='Part_Dyn_XFoot';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(ParticipationLowJointXM_foot_dyn(a-1));
            PCAtab{a+Itermice,Col}=+(ParticipationLowJointXY_foot_dyn(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='Part_Dyn_XShank';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(ParticipationLowJointXM_shank_dyn(a-1));
            PCAtab{a+Itermice,Col}=+(ParticipationLowJointXY_shank_dyn(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='Part_Dyn_XThigh';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(ParticipationLowJointXM_thigh_dyn(a-1));
            PCAtab{a+Itermice,Col}=+(ParticipationLowJointXY_thigh_dyn(a-1));
            a=a+1;
            
        end
    end
    
    
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='Part_Dyn_YFoot';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(ParticipationLowJointYM_foot_dyn(a-1));
            PCAtab{a+Itermice,Col}=+(ParticipationLowJointYY_foot_dyn(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='Part_Dyn_YShank';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(ParticipationLowJointYM_shank_dyn(a-1));
            PCAtab{a+Itermice,Col}=+(ParticipationLowJointYY_shank_dyn(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='Part_Dyn_YThigh';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(ParticipationLowJointYM_thigh_dyn(a-1));
            PCAtab{a+Itermice,Col}=+(ParticipationLowJointYY_thigh_dyn(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='Part_Dyn_ZFoot';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(ParticipationLowJointZM_foot_dyn(a-1));
            PCAtab{a+Itermice,Col}=+(ParticipationLowJointZY_foot_dyn(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='Part_Dyn_ZShank';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(ParticipationLowJointZM_shank_dyn(a-1));
            PCAtab{a+Itermice,Col}=+(ParticipationLowJointZY_shank_dyn(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='Part_Dyn_ZThigh';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(ParticipationLowJointZM_thigh_dyn(a-1));
            PCAtab{a+Itermice,Col}=+(ParticipationLowJointZY_thigh_dyn(a-1));
            a=a+1;
            
        end
    end
    
end



% REACTION AMO MAX
for fold = 1
    % MEAN Z
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='MaxPeakPZMF';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(MaxPeakPZMF(a-1));
            PCAtab{a+Itermice,Col}=+(MaxPeakPZYF(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=2;
    PCAtab{1,Col}='MaxPeakPZMA';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(MaxPeakPZMA(a-1));
            PCAtab{a+Itermice,Col}=+(MaxPeakPZYA(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=3;
    PCAtab{1,Col}='MaxPeakPZMK';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(MaxPeakPZMK(a-1));
            PCAtab{a+Itermice,Col}=+(MaxPeakPZYK(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=4;
    PCAtab{1,Col}='MaxPeakPZMH';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(MaxPeakPZMH(a-1));
            PCAtab{a+Itermice,Col}=+(MaxPeakPZYH(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=5;
    PCAtab{1,Col}='MaxPeakPZMC';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(MaxPeakPZMC(a-1));
            PCAtab{a+Itermice,Col}=+(MaxPeakPZYC(a-1));
            a=a+1;
            
        end
    end
end

% REACTION AMP MIN
for fold = 1
    % MEAN Z
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='MinPeakPZMF';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(MinPeakPZMF(a-1));
            PCAtab{a+Itermice,Col}=+(MinPeakPZYF(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=2;
    PCAtab{1,Col}='MinPeakPZMA';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(MinPeakPZMA(a-1));
            PCAtab{a+Itermice,Col}=+(MinPeakPZYA(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=3;
    PCAtab{1,Col}='MinPeakPZMK';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(MinPeakPZMK(a-1));
            PCAtab{a+Itermice,Col}=+(MinPeakPZYK(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=4;
    PCAtab{1,Col}='MinPeakPZMH';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(MinPeakPZMH(a-1));
            PCAtab{a+Itermice,Col}=+(MinPeakPZYH(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=5;
    PCAtab{1,Col}='MinPeakPZMC';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(MinPeakPZMC(a-1));
            PCAtab{a+Itermice,Col}=+(MinPeakPZYC(a-1));
            a=a+1;
            
        end
    end
end

% ENDPOINT TIME
for fold = 1
    % MEAN Z
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='EndpointPZMF';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(EndpointPZMF(a-1));
            PCAtab{a+Itermice,Col}=+(EndpointPZYF(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=2;
    PCAtab{1,Col}='EndpointPZMA';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(EndpointPZMA(a-1));
            PCAtab{a+Itermice,Col}=+(EndpointPZYA(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=3;
    PCAtab{1,Col}='EndpointPZMK';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(EndpointPZMK(a-1));
            PCAtab{a+Itermice,Col}=+(EndpointPZYK(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=4;
    PCAtab{1,Col}='EndpointPZMH';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(EndpointPZMH(a-1));
            PCAtab{a+Itermice,Col}=+(EndpointPZYH(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=5;
    PCAtab{1,Col}='EndpointPZMC';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(EndpointPZMC(a-1));
            PCAtab{a+Itermice,Col}=+(EndpointPZYC(a-1));
            a=a+1;
            
        end
    end
end

% AREA UNDER THE CURVE
for fold = 1
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='A_PXMF';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(A_PXMF(a-1));
            PCAtab{a+Itermice,Col}=+(A_PXYF(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=2;
    PCAtab{1,Col}='A_PXMA';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(A_PXMA(a-1));
            PCAtab{a+Itermice,Col}=+(A_PXYA(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=3;
    PCAtab{1,Col}='A_PXMK';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(A_PXMK(a-1));
            PCAtab{a+Itermice,Col}=+(A_PXYK(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=4;
    PCAtab{1,Col}='A_PXMH';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(A_PXMH(a-1));
            PCAtab{a+Itermice,Col}=+(A_PXYH(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=5;
    PCAtab{1,Col}='A_PXMC';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(A_PXMC(a-1));
            PCAtab{a+Itermice,Col}=+(A_PXYC(a-1));
            a=a+1;
            
        end
    end
    
    % MEAN Y
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='A_PYMF';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(A_PYMF(a-1));
            PCAtab{a+Itermice,Col}=+(A_PYYF(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=2;
    PCAtab{1,Col}='A_PYMA';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(A_PYMA(a-1));
            PCAtab{a+Itermice,Col}=+(A_PYYA(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=3;
    PCAtab{1,Col}='A_PYMK';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(A_PYMK(a-1));
            PCAtab{a+Itermice,Col}=+(A_PYYK(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=4;
    PCAtab{1,Col}='A_PYMH';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(A_PYMH(a-1));
            PCAtab{a+Itermice,Col}=+(A_PYYH(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=5;
    PCAtab{1,Col}='A_PYMC';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(A_PYMC(a-1));
            PCAtab{a+Itermice,Col}=+(A_PYYC(a-1));
            a=a+1;
            
        end
    end
    
    % MEAN Z
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='A_PZMF';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(A_PZMF(a-1));
            PCAtab{a+Itermice,Col}=+(A_PZYF(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=2;
    PCAtab{1,Col}='A_PZMA';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(A_PZMA(a-1));
            PCAtab{a+Itermice,Col}=+(A_PZYA(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=3;
    PCAtab{1,Col}='A_PZMK';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(A_PZMK(a-1));
            PCAtab{a+Itermice,Col}=+(A_PZYK(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=4;
    PCAtab{1,Col}='A_PZMH';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(A_PZMH(a-1));
            PCAtab{a+Itermice,Col}=+(A_PZYH(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=5;
    PCAtab{1,Col}='A_PZMC';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(A_PZMC(a-1));
            PCAtab{a+Itermice,Col}=+(A_PZYC(a-1));
            a=a+1;
            
        end
    end
end

% ANGLE 3D DYN
for fold = 1
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='Angle_3D_Ankle_Dyn';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(Angle3D_Ankle(a-1));
            PCAtab{a+Itermice,Col}=+(Angle3DY_Ankle(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=2;
    PCAtab{1,Col}='Angle_3D_Knee_Dyn';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(Angle3D_Knee(a-1));
            PCAtab{a+Itermice,Col}=+(Angle3DY_Knee(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=3;
    PCAtab{1,Col}='Angle3D_Hip_Dyn';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(Angle3D_Hip(a-1));
            PCAtab{a+Itermice,Col}=+(Angle3DY_Hip(a-1));
            a=a+1;
            
        end
    end
    
end

% %Dynamic position
% for fold = 1
%     Col=Col+1;
%     Joint=1;
%     PCAtab{1,Col}='MeanDyn_XF';
%     a=2;
%     for i=1:Ndays(nnz(Ndays))
%         for j=1:nnz(Npairs(i,:))
%
%             PCAtab{a,Col}=+(LastXSecMXF(a-1));
%             PCAtab{a+Itermice,Col}=+(LastXSecYXF(a-1));
%             a=a+1;
%
%         end
%     end
%

for fold = 1
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='MeanDyn_XF';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(PXMF_M(a-1));
            PCAtab{a+Itermice,Col}=+(PXYF_M(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='MeanDyn_XA';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(PXMA_M(a-1));
            PCAtab{a+Itermice,Col}=+(PXYA_M(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='MeanDyn_XK';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(PXMK_M(a-1));
            PCAtab{a+Itermice,Col}=+(PXYK_M(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='MeanDyn_XH';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(PXMH_M(a-1));
            PCAtab{a+Itermice,Col}=+(PXYH_M(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='MeanDyn_XC';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(PXMC_M(a-1));
            PCAtab{a+Itermice,Col}=+(PXYC_M(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='MeanDyn_YF';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(PYMF_M(a-1));
            PCAtab{a+Itermice,Col}=+(PYYF_M(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='MeanDyn_YA';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(PYMA_M(a-1));
            PCAtab{a+Itermice,Col}=+(PYYA_M(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='MeanDyn_YK';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(PYMK_M(a-1));
            PCAtab{a+Itermice,Col}=+(PYYK_M(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='MeanDyn_YH';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(PYMH_M(a-1));
            PCAtab{a+Itermice,Col}=+(PYYH_M(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='MeanDyn_YC';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(PYMC_M(a-1));
            PCAtab{a+Itermice,Col}=+(PYYC_M(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='MeanDyn_ZF';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(PZMF_M(a-1));
            PCAtab{a+Itermice,Col}=+(PZYF_M(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='MeanDyn_ZA';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(PZMA_M(a-1));
            PCAtab{a+Itermice,Col}=+(PZYA_M(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='MeanDyn_ZK';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(PZMK_M(a-1));
            PCAtab{a+Itermice,Col}=+(PZYK_M(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='MeanDyn_ZH';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(PZMH_M(a-1));
            PCAtab{a+Itermice,Col}=+(PZYH_M(a-1));
            a=a+1;
            
        end
    end
    
    Col=Col+1;
    Joint=1;
    PCAtab{1,Col}='MeanDyn_ZC';
    a=2;
    for i=1:Ndays(nnz(Ndays))
        for j=1:nnz(Npairs(i,:))
            
            PCAtab{a,Col}=+(PZMC_M(a-1));
            PCAtab{a+Itermice,Col}=+(PZYC_M(a-1));
            a=a+1;
            
        end
    end
    
end
%
% %EXTRA PARAMETERS TO TRY
% for fold = 1
%     Col=Col+1;
%     Joint=1;
%     PCAtab{1,Col}='LastXSecMXF';
%     a=2;
%     for i=1:Ndays(nnz(Ndays))
%         for j=1:nnz(Npairs(i,:))
%
%             PCAtab{a,Col}=+(LastXSecMXF(a-1));
%             PCAtab{a+Itermice,Col}=+(LastXSecYXF(a-1));
%             a=a+1;
%
%         end
%     end
%
%     Col=Col+1;
%     Joint=2;
%     PCAtab{1,Col}='LastXSecMXA';
%     a=2;
%     for i=1:Ndays(nnz(Ndays))
%         for j=1:nnz(Npairs(i,:))
%
%             PCAtab{a,Col}=+(LastXSecMXA(a-1));
%             PCAtab{a+Itermice,Col}=+(LastXSecYXA(a-1));
%             a=a+1;
%
%         end
%     end
%
%     Col=Col+1;
%     Joint=3;
%     PCAtab{1,Col}='LastXSecMXK';
%     a=2;
%     for i=1:Ndays(nnz(Ndays))
%         for j=1:nnz(Npairs(i,:))
%
%             PCAtab{a,Col}=+(LastXSecMXK(a-1));
%             PCAtab{a+Itermice,Col}=+(LastXSecYXK(a-1));
%             a=a+1;
%
%         end
%     end
%
%     Col=Col+1;
%     Joint=4;
%     PCAtab{1,Col}='LastXSecMXH';
%     a=2;
%     for i=1:Ndays(nnz(Ndays))
%         for j=1:nnz(Npairs(i,:))
%
%             PCAtab{a,Col}=+(LastXSecMXH(a-1));
%             PCAtab{a+Itermice,Col}=+(LastXSecYXH(a-1));
%             a=a+1;
%
%         end
%     end
%
%     Col=Col+1;
%     Joint=5;
%     PCAtab{1,Col}='LastXSecMXI';
%     a=2;
%     for i=1:Ndays(nnz(Ndays))
%         for j=1:nnz(Npairs(i,:))
%
%             PCAtab{a,Col}=+(LastXSecMXI(a-1));
%             PCAtab{a+Itermice,Col}=+(LastXSecYXI(a-1));
%             a=a+1;
%
%         end
%     end
%
%     % MEAN Y
%     Col=Col+1;
%     Joint=1;
%     PCAtab{1,Col}='LastXSecMYF';
%     a=2;
%     for i=1:Ndays(nnz(Ndays))
%         for j=1:nnz(Npairs(i,:))
%
%             PCAtab{a,Col}=+(LastXSecMYF(a-1));
%             PCAtab{a+Itermice,Col}=+(LastXSecYYF(a-1));
%             a=a+1;
%
%         end
%     end
%
%     Col=Col+1;
%     Joint=2;
%     PCAtab{1,Col}='LastXSecMYA';
%     a=2;
%     for i=1:Ndays(nnz(Ndays))
%         for j=1:nnz(Npairs(i,:))
%
%             PCAtab{a,Col}=+(LastXSecMYA(a-1));
%             PCAtab{a+Itermice,Col}=+(LastXSecYYA(a-1));
%             a=a+1;
%
%         end
%     end
%
%     Col=Col+1;
%     Joint=3;
%     PCAtab{1,Col}='LastXSecMYK';
%     a=2;
%     for i=1:Ndays(nnz(Ndays))
%         for j=1:nnz(Npairs(i,:))
%
%             PCAtab{a,Col}=+(LastXSecMYK(a-1));
%             PCAtab{a+Itermice,Col}=+(LastXSecYYK(a-1));
%             a=a+1;
%
%         end
%     end
%
%     Col=Col+1;
%     Joint=4;
%     PCAtab{1,Col}='LastXSecMYH';
%     a=2;
%     for i=1:Ndays(nnz(Ndays))
%         for j=1:nnz(Npairs(i,:))
%
%             PCAtab{a,Col}=+(LastXSecMYH(a-1));
%             PCAtab{a+Itermice,Col}=+(LastXSecYYH(a-1));
%             a=a+1;
%
%         end
%     end
%
%     Col=Col+1;
%     Joint=5;
%     PCAtab{1,Col}='LastXSecMYK';
%     a=2;
%     for i=1:Ndays(nnz(Ndays))
%         for j=1:nnz(Npairs(i,:))
%
%             PCAtab{a,Col}=+(LastXSecMYK(a-1));
%             PCAtab{a+Itermice,Col}=+(LastXSecYYK(a-1));
%             a=a+1;
%
%         end
%     end
%
%     % MEAN Z
%     Col=Col+1;
%     Joint=1;
%     PCAtab{1,Col}='LastXSecMZF';
%     a=2;
%     for i=1:Ndays(nnz(Ndays))
%         for j=1:nnz(Npairs(i,:))
%
%             PCAtab{a,Col}=+(LastXSecMZF(a-1));
%             PCAtab{a+Itermice,Col}=+(LastXSecYZF(a-1));
%             a=a+1;
%
%         end
%     end
%
%     Col=Col+1;
%     Joint=2;
%     PCAtab{1,Col}='LastXSecMZA';
%     a=2;
%     for i=1:Ndays(nnz(Ndays))
%         for j=1:nnz(Npairs(i,:))
%
%             PCAtab{a,Col}=+(LastXSecMZA(a-1));
%             PCAtab{a+Itermice,Col}=+(LastXSecYZA(a-1));
%             a=a+1;
%
%         end
%     end
%
%     Col=Col+1;
%     Joint=3;
%     PCAtab{1,Col}='LastXSecMZK';
%     a=2;
%     for i=1:Ndays(nnz(Ndays))
%         for j=1:nnz(Npairs(i,:))
%
%             PCAtab{a,Col}=+(LastXSecMZK(a-1));
%             PCAtab{a+Itermice,Col}=+(LastXSecYZK(a-1));
%             a=a+1;
%
%         end
%     end
%
%     Col=Col+1;
%     Joint=4;
%     PCAtab{1,Col}='LastXSecMZH';
%     a=2;
%     for i=1:Ndays(nnz(Ndays))
%         for j=1:nnz(Npairs(i,:))
%
%             PCAtab{a,Col}=+(LastXSecMZH(a-1));
%             PCAtab{a+Itermice,Col}=+(LastXSecYZH(a-1));
%             a=a+1;
%
%         end
%     end
%
%     Col=Col+1;
%     Joint=5;
%     PCAtab{1,Col}='LastXSecMZI';
%     a=2;
%     for i=1:Ndays(nnz(Ndays))
%         for j=1:nnz(Npairs(i,:))
%
%             PCAtab{a,Col}=+(LastXSecMZI(a-1));
%             PCAtab{a+Itermice,Col}=+(LastXSecYZI(a-1));
%             a=a+1;
%
%         end
%     end
% end



%%


%clearvars -except PCAtab PercentageTimeBeingShock PercentageTimeBeingShockY Nbshock NbshockTimeBin NbshockTimeBinY NbshockY ZYmean ZMmean ZY ZM XM XY YY YM T TY ZMmean10 ZYmean10




% %%
% % ExpNb=54;
% % Ndays = [1 0];
% % Npairs = [3 0]; %En1 activation day1
% %
% % ExpNb=53;
% % Ndays = [2 0];
% % Npairs = [4 5 6 7 8 9 10 0]; %En1 activation day2
%
% % En1 activatived + WT
% % ExpNb=52;
% % Ndays = [2 0];
% % Npairs = [1 2 3 4 0];
%
% % ExpNb=54;
% % Ndays = [2 0];
% % Npairs = [1 2 0];
% % - - - REPLACEMENT 31 D1 3 4 D2 2 5
%
%
% % Cond1 : D1 Engrailed1 WT
% % Cond1 : D3 Engrailed1 WT activated
%
% % Cond1 : WT
% % Cond1 : WT activated
%
% % Cond1 : WT
% % Cond1 : WT
%
% close all
% figure
% hold on
%
% Cond1_d1=find(Data(:,1)==1 & Data(:,2)==1)
%
% for i=1:numel(Cond1_d1)
%
%     toplot=Cond1_d1(i);
%
%     plot(SCORE(toplot,1),SCORE(toplot,2),'xb')
%
% end
%
%
% Cond1_d2=find(Data(:,1)==1 & Data(:,2)==2)
%
% for i=1:numel(Cond1_d2)
%
%     toplot=Cond1_d2(i);
%
%     plot(SCORE(toplot,1),SCORE(toplot,2),'ob')
%
% end
%
%
%
% Cond2_d1=find(Data(:,1)==2 & Data(:,2)==1)
%
% for i=1:numel(Cond2_d1)
%
%     toplot=Cond2_d1(i);
%
%     plot(SCORE(toplot,1),SCORE(toplot,2),'xr')
%
% end
%
% Cond2_d2=find(Data(:,1)==2 & Data(:,2)==2)
%
% for i=1:numel(Cond2_d2)
%
%     toplot=Cond2_d2(i);
%
%     plot(SCORE(toplot,1),SCORE(toplot,2),'or')
%
% end
%
%
% Cond3_d1=find(Data(:,1)==3 & Data(:,2)==1)
%
% for i=1:numel(Cond3_d1)
%
%     toplot=Cond3_d1(i);
%
%     plot(SCORE(toplot,1),SCORE(toplot,2),'xg')
%
% end
%
% Cond3_d2=find(Data(:,1)==3 & Data(:,2)==2)
%
% for i=1:numel(Cond3_d2)
%     
%     toplot=Cond3_d2(i);
%     
%     plot(SCORE(toplot,1),SCORE(toplot,2),'og')
%     
% end
